<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>无聊的小阳阳的个人博客</title>
    <description>小阳阳写东西的地方
</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Sun, 02 Jun 2019 19:36:44 +0800</pubDate>
    <lastBuildDate>Sun, 02 Jun 2019 19:36:44 +0800</lastBuildDate>
    <generator>Jekyll v3.8.5</generator>
    
      <item>
        <title>年终总结</title>
        <description>&lt;p&gt;2018年一晃而过，感觉2017年还是昨天的样子，2018年竟已经到达最后一天。&lt;/p&gt;

&lt;p&gt;2018年上半年在公司实习，5月回学校，刚到学校没几天，就收到外婆离世的噩耗。逝者已矣！子欲养而亲不待！唯剩叹息！葬礼过后赶回学校忙着毕业设计的事情，忙忙碌碌，匆匆忙忙，转眼毕业。同学室友都各奔东西，徒留无限伤感，再见不知会是何时。下半年新生入学，在新学期的新鲜感过去之后，又添了许多茫然。每天庸庸碌碌，没有目标，时间一天一天的过去，也不知道自己在学一些什么。现在到年底了，还不知道自己明年找工作的时候，到底是应该投算法岗还是找研发岗。&lt;/p&gt;

&lt;p&gt;下半年每天实验室教室食堂寝室之间奔走，过得很是乏味。已经没有了入学时好好学习的雄心壮志，现在想来，充满了罪恶感，觉得自己不能这样，希望新的一年自己能够洗心革面好好学习，找个好工作！
2018年说起来，也颇读了一些书，然而那些名著大块头，拿起来了又放下，完全读不进去，反倒是那些小品文，绘本什么的，反倒不知不觉就读完了。以前大一的时候，陈喜辉老师给我们上现代文学选读的时候，也说过，不管什么书，还是要以读得进去为好，能读得进去的书，才是对自己有用的书（大概是这么说的，原话已经忘记）。开卷有益！&lt;/p&gt;

&lt;p&gt;总得来说，2018年印象最深刻的书，还是要数《朱生豪情书》了，哈哈。这本书是朱生豪追妻子宋清如时写的一封封书信，其肉麻，其甜腻，大概让现代的很多男生女生都自愧弗如。读情书，有得时候会不自觉的带入自己，想象着，有一个男生也这样的爱慕着我，欣赏着我，憧憬着，像这样的完美的爱情！除了《情书》，这一年读的最多的大概是短篇小说了。把毛姆的一本短篇小说选集看完了，每天睡前看一篇，感觉也很有味道，不知不觉就把一本书给看完了。毛姆的小说，多数很有哲理，关于人生的选择，关于讽刺社会现实等等，小说本身也很有意思。其次，还读了欧亨利的许多篇短篇小说，欧亨利的小说大多非常有趣，毕竟“欧亨利式结尾”嘛，往往出人意料，又在情理之中。读欧亨利的小说，既有抨击社会现实的，又有写人间温情的，在读完小说之后，往往心里会有一点温暖。毛姆的小说是冷眼看世界，而欧亨利的小说，却总会让你相信，人间有真情，世间有真爱。&lt;/p&gt;

&lt;p&gt;2018年看的电影没有很多，印象最深刻的就是《美丽人生》了，让人非常的感动，骗了我许许多多的泪水。其次在影院看了一些爆米花电影，这些都没什么好说的。&lt;/p&gt;

&lt;p&gt;2018年技术上没有什么长进，也就是年初在公司实习的时候，写了一些代码，回学校以后，忙着各种各样的事情，也没学什么知识。暑假读了2个多月的论文，对怎么找论文，怎么读论文，怎么做笔记等有了一个初步的感觉。下半年，前半个学期在上课，以及给实习大数据集团干活，学了一些大数据管理的一些工具，对大数据处理这些开源工具有了一些初步的了解，后来因为实在忙不过来，把这个实习给辞了，专心给导师干活。下半个学期，看了一点机器学习的视频，找了一些源代码研究，然而并不能太看懂。&lt;/p&gt;

&lt;p&gt;总得来说，2018年相较2017年读的书要多一点，这一点值得肯定，但是技术上和学习上，没有付出太多努力，还是自己不够认真，天天就想着玩，三天打鱼两天晒网，希望自己新的一年能够更加努力，告别懒懒散散的自己，做一个自律自强，奋发向上的自己吧！&lt;/p&gt;
</description>
        <pubDate>Mon, 31 Dec 2018 22:20:00 +0800</pubDate>
        <link>http://localhost:4000/2018/12/final-report</link>
        <guid isPermaLink="true">http://localhost:4000/2018/12/final-report</guid>
        
        <category>年终总结</category>
        
        <category>学习生活</category>
        
        
      </item>
    
      <item>
        <title>年终总结</title>
        <description>&lt;p&gt;2018年一晃而过，感觉2017年还是昨天的样子，2018年竟已经到达最后一天。&lt;/p&gt;

&lt;p&gt;2018年上半年在公司实习，5月回学校，刚到学校没几天，就收到外婆离世的噩耗。逝者已矣！子欲养而亲不待！唯剩叹息！葬礼过后赶回学校忙着毕业设计的事情，忙忙碌碌，匆匆忙忙，转眼毕业。同学室友都各奔东西，徒留无限伤感，再见不知会是何时。下半年新生入学，在新学期的新鲜感过去之后，又添了许多茫然。每天庸庸碌碌，没有目标，时间一天一天的过去，也不知道自己在学一些什么。现在到年底了，还不知道自己明年找工作的时候，到底是应该投算法岗还是找研发岗。&lt;/p&gt;

&lt;p&gt;下半年每天实验室教室食堂寝室之间奔走，过得很是乏味。已经没有了入学时好好学习的雄心壮志，现在想来，充满了罪恶感，觉得自己不能这样，希望新的一年自己能够洗心革面好好学习，找个好工作！
2018年说起来，也颇读了一些书，然而那些名著大块头，拿起来了又放下，完全读不进去，反倒是那些小品文，绘本什么的，反倒不知不觉就读完了。以前大一的时候，陈喜辉老师给我们上现代文学选读的时候，也说过，不管什么书，还是要以读得进去为好，能读得进去的书，才是对自己有用的书（大概是这么说的，原话已经忘记）。开卷有益！&lt;/p&gt;

&lt;p&gt;总得来说，2018年印象最深刻的书，还是要数《朱生豪情书》了，哈哈。这本书是朱生豪追妻子宋清如时写的一封封书信，其肉麻，其甜腻，大概让现代的很多男生女生都自愧弗如。读情书，有得时候会不自觉的带入自己，想象着，有一个男生也这样的爱慕着我，欣赏着我，憧憬着，像这样的完美的爱情！除了《情书》，这一年读的最多的大概是短篇小说了。把毛姆的一本短篇小说选集看完了，每天睡前看一篇，感觉也很有味道，不知不觉就把一本书给看完了。毛姆的小说，多数很有哲理，关于人生的选择，关于讽刺社会现实等等，小说本身也很有意思。其次，还读了欧亨利的许多篇短篇小说，欧亨利的小说大多非常有趣，毕竟“欧亨利式结尾”嘛，往往出人意料，又在情理之中。读欧亨利的小说，既有抨击社会现实的，又有写人间温情的，在读完小说之后，往往心里会有一点温暖。毛姆的小说是冷眼看世界，而欧亨利的小说，却总会让你相信，人间有真情，世间有真爱。&lt;/p&gt;

&lt;p&gt;2018年看的电影没有很多，印象最深刻的就是《美丽人生》了，让人非常的感动，骗了我许许多多的泪水。其次在影院看了一些爆米花电影，这些都没什么好说的。&lt;/p&gt;

&lt;p&gt;2018年技术上没有什么长进，也就是年初在公司实习的时候，写了一些代码，回学校以后，忙着各种各样的事情，也没学什么知识。暑假读了2个多月的论文，对怎么找论文，怎么读论文，怎么做笔记等有了一个初步的感觉。下半年，前半个学期在上课，以及给实习大数据集团干活，学了一些大数据管理的一些工具，对大数据处理这些开源工具有了一些初步的了解，后来因为实在忙不过来，把这个实习给辞了，专心给导师干活。下半个学期，看了一点机器学习的视频，找了一些源代码研究，然而并不能太看懂。&lt;/p&gt;

&lt;p&gt;总得来说，2018年相较2017年读的书要多一点，这一点值得肯定，但是技术上和学习上，没有付出太多努力，还是自己不够认真，天天就想着玩，三天打鱼两天晒网，希望自己新的一年能够更加努力，告别懒懒散散的自己，做一个自律自强，奋发向上的自己吧！&lt;/p&gt;
</description>
        <pubDate>Mon, 31 Dec 2018 22:20:00 +0800</pubDate>
        <link>http://localhost:4000/2018/12/final-report-(copy)</link>
        <guid isPermaLink="true">http://localhost:4000/2018/12/final-report-(copy)</guid>
        
        <category>年终总结</category>
        
        <category>学习生活</category>
        
        
      </item>
    
      <item>
        <title>VerdictDB Universalizing Approximate Query Processing</title>
        <description>&lt;h2 id=&quot;摘要&quot;&gt;摘要&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;近似查询处理学术研究很充裕，工业实践比较少&lt;/li&gt;
  &lt;li&gt;来自各数据库内部的阻力—-不想改代码！&lt;/li&gt;
  &lt;li&gt;近似查询的使用将迫使用户抛弃现使用的数据库—-不现实！&lt;/li&gt;
  &lt;li&gt;因此作者提出一种通用的解决方案—一个数据库无关近似查询处理引擎。&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;verdict基本方法&quot;&gt;VERDICT基本方法&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;使AQP居于驱动层，不改变原有数据库&lt;/li&gt;
  &lt;li&gt;引进中间件，重写用户请求，用户请求以关系型数据库语义像数据库发送并获得其近似结果&lt;/li&gt;
  &lt;li&gt;整个近似查询处理过程被编译成SQL形式，包括取样、近似处理以及错误估计&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;challenges&quot;&gt;Challenges&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;统计正确性—其他通过外键约束、修改join算法来实现，对于中间件来说，这些方法将不再适用&lt;/li&gt;
  &lt;li&gt;中间件效率—中间件不能承担大量计算，因为其没有查询优化以及分布式资源&lt;/li&gt;
  &lt;li&gt;服务器效率—错误估计须被表达成SQL查询，这将及其昂贵并且与近似查询的初中初衷相违背&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;设计标准&quot;&gt;设计标准&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;提供普适性—能支持大部分的分析型需求&lt;/li&gt;
  &lt;li&gt;提供统计正确性—在不须访问数据库内部的前提之下，无偏近似和粗偶估计&lt;/li&gt;
  &lt;li&gt;保证效率—需要比一般的查询处理快得多&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;我们的方法&quot;&gt;我们的方法&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;通过使用subsampling的理论规避了bootstrap的计算成本&lt;/li&gt;
  &lt;li&gt;提出一种有效计算的选择，称之为变分二次抽样&lt;/li&gt;
  &lt;li&gt;只依赖SQL表述来达到分层抽样的目的&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;系统架构&quot;&gt;系统架构&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/assets/postsimg/verdict-1.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;verdictdb内部结构&quot;&gt;VERDICTDB内部结构&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/assets/postsimg/verdict-2.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;样本准备和查询处理&quot;&gt;样本准备和查询处理&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/assets/postsimg/verdict-3.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;取样方法&quot;&gt;取样方法&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;均匀取样—每个样本都能以相同的概率被抽取到&lt;/li&gt;
  &lt;li&gt;哈希取样（universe取样）—不放回取样，从n个里面取m个&lt;/li&gt;
  &lt;li&gt;分层抽样&lt;/li&gt;
  &lt;li&gt;不规则取样—以上哪种都不是的取样&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;接下来是文章的一大重点—变分二次取样
很多公式，我也看得不是很懂，回头再慢慢深入看吧，先补补概率论知识先&lt;/p&gt;

&lt;h2 id=&quot;总结&quot;&gt;总结&lt;/h2&gt;

&lt;p&gt;干货满满的一篇文章。把如何搭建一个近似查询处理系统的过程描写的非常的详细。从顶层的接口设计，到最底层的SQL编写，都写的非常认真。由浅入深，理论研究也非常的靠谱。
值得一读再读的论文！&lt;/p&gt;
</description>
        <pubDate>Sun, 02 Sep 2018 18:32:20 +0800</pubDate>
        <link>http://localhost:4000/2018/09/VerdictDB-Universalizing-Approximate-Query-Processing</link>
        <guid isPermaLink="true">http://localhost:4000/2018/09/VerdictDB-Universalizing-Approximate-Query-Processing</guid>
        
        <category>论文阅读</category>
        
        <category>读书笔记</category>
        
        
      </item>
    
      <item>
        <title>Megastore Providing Scalable, Highly Available Storage for Interactive Services</title>
        <description>&lt;h1 id=&quot;摘要&quot;&gt;摘要&lt;/h1&gt;
&lt;p&gt;Megastore 是一个存储系统，为了满足现今的在线交互服务需求。Megastore以一种新的方式，结合了NoSQL数据库的可扩展性以及传统的关系型数据库的便捷性，并且同时提供了强一致性保证及高可用性。我们在细粒度的数据分片上提供完全的ACID保证。这种分片允许我们在一个较宽的网络范围内同步复制写操作，在一个可接受的延迟内，并能够支持数据中心间的无缝故障转移。这篇论文描述了Megastore的语义及复制算法。同时还描述了我们在支持一大堆的谷歌产品服务时的经验。&lt;/p&gt;

&lt;h1 id=&quot;绪论&quot;&gt;绪论&lt;/h1&gt;
&lt;p&gt;在线交互服务迫使存储系统满足桌面应用整合到云端的需求。类似邮件、在线文档以及社交网络的服务呈指数型增长，对现有的基础设施带来了极大的考验。&lt;/p&gt;

&lt;p&gt;首先，互联网带来了巨量的潜在用户，所以，应用必须考虑到扩展性。应用可以以MySql作为其数据库迅速构建，但是把服务扩展到百万级别用户需要对其存储基础架构一个完全的重新设计。其次，服务为用户而竞争。这需要功能的快速开发以及快速进入市场。第三，服务必须有保证，所以，存储系统必须低延迟。第四，服务必须给用户提供一致性视图–更新的的结果必须立马能看到并且保存下来。看到对一个云传播的页面的编辑消失，不管多么令人信服，都是一个很糟糕的用户体验。最后，用户期待服务是7*24小时的，所以服务必须是高可用的。服务必须能在各种各样的故障中稳定运行，包括个别磁盘错误、机器错误、&lt;/p&gt;

&lt;p&gt;这些需求本身是互相矛盾的。关系型数据库提供对快速构建应用的丰富支持，但是很难扩展到百万级别用户。NoSQL数据可如谷歌的 BigTable、Apache的Hbase、Facebook的 Cassandra等都是高度可扩展的，但是仅有有限的API及松一致性给限制了复杂应用的开发。在远距离数据中心间复制数据并提供低延迟具有很大的挑战性，在保证复制数据间的一致性的同时，尤其出现故障时。&lt;/p&gt;

&lt;p&gt;Megastore正是为了满足今日的交互性在线鼓舞的需求而开发的存储系统。它的创新点在于：它结合了NoSql数据可的可扩展性以及传统的关系型数据可的便捷性。它使用同步复制来提供高可用性及数据的一致性视图。简言之，它在远距离副本上提供了完全的ACID语义以及低延迟来支持交互性应用。&lt;/p&gt;

&lt;p&gt;我们通过在关系型数据库和NoSQL的的一片中间地带完成了这个设计：我们把数据分片存储并分别复制分片，并在分片上提供完全的ACID语义，而在分片之间仅提供弱一致性。我么提供传统的数据库的功能，包括二级索引等，但是仅支持那些能够在用户可容忍延迟内扩展的功能，以及那些我们的分片架构能够支持的语义。我们主张大部分互联网的数据都是可以被合适的分片的（比如按用户），从而使这种算法有限，进一步使得接下来的一些功能特性能减轻开发云应用的负担。&lt;/p&gt;

&lt;p&gt;Megastore使用Paxos算法。&lt;/p&gt;

&lt;p&gt;Megastore 在谷歌被广泛使用了很多年。每天处理了30亿次的写和200亿次的读事务，并存储了来自全球的数据中心的大概1个PB的数据。&lt;/p&gt;

&lt;p&gt;这篇论文的主要贡献在于：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;数据模型及存储系统的设计，使得交互性应用能够快速开发并从开始就具有高可用性和高扩展性&lt;/li&gt;
  &lt;li&gt;Paxos复制算法的实现，对远距离分布的数据中间的一致性低延迟优化来为系统提供高可用性的算法&lt;/li&gt;
  &lt;li&gt;我们的Megastore系统在谷歌的大规模部署的实验报告&lt;/li&gt;
&lt;/ol&gt;

&lt;h1 id=&quot;面向高可用和高扩展&quot;&gt;面向高可用和高扩展&lt;/h1&gt;

&lt;p&gt;与我们对一个全球的、可靠的、任意大规模的存储平台的需求相反，我们的硬件基础确实受地理位置限制、易于故障、容量有限。我们必须把这些组件组成为一个统一的整体并提供良好的吞吐量和可靠性。&lt;/p&gt;

&lt;p&gt;因此，我们实现了两种方法：
	• 为了提高可用性，我们实现了同步的容错的日志复制器，并对远距离连接进行了优化。
	• 为了扩展，我们把数据划分成巨多的小型数据库，每个数据库拥有其自己的可复制的日志，并存储在一个支持副本的NoSQL数据库中&lt;/p&gt;

&lt;h3 id=&quot;复制&quot;&gt;复制&lt;/h3&gt;
&lt;p&gt;为了应对物理灾难，提高云服务的可用性，备份必不可少。&lt;/p&gt;
&lt;h5 id=&quot;策略&quot;&gt;策略&lt;/h5&gt;
&lt;p&gt;评估以下三种被广泛使用的策略：
	• 主从异步策略 非阻塞性，需要一致性协议。
	• 主从同步策略  阻塞性，主从故障需要外部系统的检测。
	• 乐观复制策略  同一个副本组的成员都可以接受改变，改变在组内异步传播。可用性和延迟都比较优秀。然而，提交时，全局的改变顺序未知，所以事务是不可能的。&lt;/p&gt;

&lt;p&gt;我们弃用了故障时可能丢失数据的策略。也丢弃了不支持ACID事务的策略。尽管最终一致的系统具有操作优势，但目前在快速应用程序开发中放弃读取 - 修改 - 写入习惯是非常困难的。&lt;/p&gt;

&lt;p&gt;我们也放弃了重量级主节点的选择。需要一系列高延迟操作的故障转移经常导致一个用户可见的中断，并且非常的复杂。如果我们能够完全避开突出的主节点，为什么要构建一个容错系统来实现仲裁和故障转移工作呢？&lt;/p&gt;

&lt;h5 id=&quot;算法paxos&quot;&gt;算法Paxos&lt;/h5&gt;
&lt;p&gt;我们使用Paxos算法，一种有效的，容错的一致性算法，并且不须强主节点。我们在一个匀称节点组间复制写前日志。任意节点都能够发起读和写。每个日志都附加了来自大多数副本的确认的块，并且少数群集中的副本能够跟上当它们能够时– 算法的固有容错性消除了对区分“失败”状态的需要。一种对Paxos的扩展，如4.4.1所示，允许对任意最新副本的读操作。另一个扩展支持议论写。&lt;/p&gt;

&lt;p&gt;尽管Paxos提供了容错性，使用单一日志依然有局限性。随着副本在一个广泛的领域上传播，通信延迟限制吞吐量。此外，当当前没有复制或大部分写确认都失败时，进度将被阻碍。传统SQL数据库中，使用同步复制日志将导致大范围影响的中断。故为提高可用性和吞吐量，我们使用多重复制日志，每个日志只负责自己的数据分片。&lt;/p&gt;

&lt;h3 id=&quot;分片和位置&quot;&gt;分片和位置&lt;/h3&gt;
&lt;p&gt;为了扩展复制架构和最优化根本的数据存储的性能，我们给应用在他们数据的分片和位置上细粒度的控制。&lt;/p&gt;

&lt;h5 id=&quot;实体组entity-groups&quot;&gt;实体组（Entity Groups）&lt;/h5&gt;
&lt;p&gt;为了提升吞吐量和局部化故障，我们把诗句分成实体组的集合，每个实体组独立同步的在一篇区域上复制。最底层的数据存储在么个数据中心的一个可扩展的NoSQL数据库中。见图一。
&lt;img src=&quot;/assets/postsimg/mega-1.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;组内一阶段ACID事务（通过Paxos算法复制）。实体组之间的操作依赖昂贵的两阶段提交，但是一般使用Megastore的高效的异步消息。发送实体组中的事务将一个或多个消息放入队列中; 接收实体组中的事务原子地消耗这些消息并应用随后的改变。
我们在逻辑远距离实体组上使用异步消息机制，而不是物理上远距离的副本之间。数据中心之间的所用网络拥堵都是在复制操作之间的，这些操作是异步且一致的。&lt;/p&gt;

&lt;p&gt;一个实体组的本地索引遵从ACID语义；实体组之间仅有松一致性。见图2所示，实体组之间的不同操作。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/postsimg/mega-2.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;选择实体组边界&quot;&gt;选择实体组边界&lt;/h5&gt;

&lt;p&gt;选择合理的实体组边界非常重要。因为实体组提供了对数据的一种快速操作方式。实体组太小了，导致昂贵的组件操作，实体组太大导致放太多无关数据导致不必要的写，降低吞吐量。&lt;/p&gt;

&lt;p&gt;下面的例子展示了应用如何在这些约束下工作的：
Email ：每个邮箱账户为一个天然的实体组
博客：多层实体组。每个用户有一个画像，天然的一个实体组。但是，博客通常是协作的，并且没有永久用户。我们需要实体组来保存博客的提交及元数据。第三个实体组是每个博客独一无二的名字。当一个用户操作同时影响博客和用户画像时，应用依赖异步消息机制。对于一个低拥堵的操作比如创建一个博客并为它命名，两阶段的操作更加方便性能更好。
地图：把地球划分成不相重叠的块，作为实体组。&lt;/p&gt;

&lt;p&gt;几乎每个基于Megastore的应用都找到了自己划分实体组边界的方式。&lt;/p&gt;

&lt;h5 id=&quot;物理布局&quot;&gt;物理布局&lt;/h5&gt;
&lt;p&gt;我们使用谷歌的Bigtable作为单一数据中心的可扩展的容错存储，使得我们能够支持通过在多行之间传播操作来支持任意读和写。&lt;/p&gt;

&lt;p&gt;我们通过让应用控制数据的位置来降低延迟提升吞吐量：在Bigtable的实例之间选择、并指定一个实例的位置。&lt;/p&gt;

&lt;p&gt;为了降低延迟，应用视图把数据靠近用户并保持副本之间相互接近。把每个实体组放在它们被访问最多的那个地理区或大陆。在这个区域，他们会放置3-4个数据中心的副本以防物理故障。&lt;/p&gt;

&lt;p&gt;为了低延迟、命中效率和吞吐量，每个实体组的数据被保存在Bigtable的邻近范围的行。我们的架构语言能够让应用控制数据的位置，存储数据令其可以在相邻行同时被访问或是非规范化到同一行。&lt;/p&gt;

&lt;h1 id=&quot;megastore-之旅&quot;&gt;Megastore 之旅&lt;/h1&gt;
&lt;p&gt;Megastore将其架构映射到一系列被自习挑选的功能来鼓励可扩展应用的快速开发。这部分讲述最终实现的面向开发者的功能以及我们所做的折中选择。&lt;/p&gt;

&lt;h3 id=&quot;api设计哲学&quot;&gt;API设计哲学&lt;/h3&gt;
&lt;p&gt;ACID事务简单来源于正确性，但是性能同样重要。Megastore强调成本透明的API，以使得运行时成本与应用开发者的直觉一致。&lt;/p&gt;

&lt;p&gt;规范的关系型模式依赖于查询时join来支持用户操作。但这不是Megastore上应用的正确模型，有如下一些原因：
	• 高体量的交互型工作量更多受益于可预测的性能而不是昂贵的查询语言。
	• 读支配写，在我们的目标应用中，所以应该更加关注读的时间而不是写的时间。
	• 存储和查询层级数据在键值对存储中、比如Bigtable中非常的直接&lt;/p&gt;

&lt;p&gt;基于此，我们设计的数据模型和架构语言在物理位置上提供细粒度的控制。层级布局和声明的反规范化帮助消除连接需求。查询专门扫描或查找特定表和索引。&lt;/p&gt;

&lt;p&gt;连接（join），当需要时，在应用代码中实现。我们提供一个合并阶段合并连接算法的一种实现，其中用户提供返回相同表的以相同顺序排列的主键的多重查询，我们然后返回所有给定查询的键值的连接。&lt;/p&gt;

&lt;p&gt;我们也有用并行查询实现外连接的应用。这是典型的使用一个索引查找，并跟着一个并行的索引查找，使用第一个索引查找的结果。我们发现，当第二个索引并行地查找完成时且第一个查找的结果的数量理所当然的小时，这能够很好的替代SQL风格的连接。&lt;/p&gt;

&lt;p&gt;尽管schema改变需要对对应查询实现代码的修改，系统依然能够保证，功能能够以一个对性能暗示的清晰理解被构建。比如，当用户（可能没有数据库的背景）发现他们在写一个表示嵌套循环的join的算法时，他们马上能够意识到最好添加一个索引并使用上述基于索引的jion算法。&lt;/p&gt;

&lt;h3 id=&quot;数据模型&quot;&gt;数据模型&lt;/h3&gt;
&lt;p&gt;Megastore定义了一种介于关系型数据库的元组和NoSQL的精确的行列存储间的数据模型。正如在关系型数据库，数据模型由一个架构声明并且是强类型的。&lt;/p&gt;

&lt;p&gt;表要么是entity group root table，要么是child table。
&lt;img src=&quot;/assets/postsimg/mega-3.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;键上预连接&quot;&gt;键上预连接&lt;/h5&gt;
&lt;p&gt;每个实体被映射成BIgtable的一个单行，主键串联起来构成Bigtable的行主键，其他属性分别占用Bigtable的一列。&lt;/p&gt;

&lt;p&gt;user和photo使用同一个user_id，保证顺序，加速join&lt;/p&gt;

&lt;h5 id=&quot;索引&quot;&gt;索引&lt;/h5&gt;

&lt;p&gt;本地索引 对实体组内部的索引，原子更新，与实体数据保持一致性
全局索引 跨实体组，不保证最近更新
Megastore支持的其他索引功能
	• storing从句：添加额外属性，快速访问
	• 重复索引：PhotosByTag 在重复属性上的索引
	• 内联索引：提取信息碎片，与重复索引组合，还能够建立多对多关系&lt;/p&gt;

&lt;h5 id=&quot;映射到bigtable&quot;&gt;映射到Bigtable&lt;/h5&gt;
&lt;p&gt;&lt;img src=&quot;/assets/postsimg/mega-4.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;在Bigtable行中，存实体组的事务和副本元数据，包括事务日志。&lt;/p&gt;

&lt;h1 id=&quot;事务和并发控制&quot;&gt;事务和并发控制&lt;/h1&gt;
&lt;p&gt;每个实体组可以看成一个迷你数据库，提供ACID语义。一个事务发起，将把它的改变写入实体组的写前日志，然后将改变应用到数据。&lt;/p&gt;

&lt;p&gt;Bigtable允许在同一个行列对中存多个带有不同时间戳的值。使用这种特性来实现多版本并发控制。使最后一次完全更新的事务的时间戳进行读，以防止部分读。读和写不会互相锁，读独立于写事务之外。&lt;/p&gt;

&lt;p&gt;Megastore提供当前的、快照的、不一致的读。当前–确定所有的事务已提交；快照–读已提交的事务的读，尽管当前还有事务未提交。不一致–忽略日志状态，允许部分更新数据&lt;/p&gt;

&lt;p&gt;写事务开始于当前读。一次性提交所有变化到日志入口，给一个当前最高时间戳，用Paxos追加到日志。该协议使用乐观锁：尽管可能有多个写试图追加日志，仅有一个能够成功。其他失败的将会观察到，并退让，重试。建议锁有助于减少竞争。对特定前端服务器会话的批量写能够避免竞争。&lt;/p&gt;

&lt;p&gt;完整的事务的生命周期如下：
&lt;img src=&quot;/assets/postsimg/mega-5.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;队列&quot;&gt;队列&lt;/h5&gt;
&lt;p&gt;在组间操作时使用，提供事务消息，在单个事务中批量更新，或推迟工作。一个实体组上的事务能够原子性的发送或收到多条消息来更新其实体。每条消息有单一的发送实体组和接收实体组，如果推迟的话，消息的传递是异步的。&lt;/p&gt;

&lt;p&gt;队列提供一种对多实体组进行操作的方式。考虑一个日历应用，每个日历是一个独立的实体组，我们想要向其他日历发送邀请。一个简单的事务是原子性的向许多不同的日历应用发送原子消息。每个日历收到消息后将会开启一个自己的事务来处理该条消息，然后将会更新被邀请者的状态并删除该消息。&lt;/p&gt;

&lt;p&gt;关系型数据库使用消息队列已经有很长的历史了。我们提供一种新的支持为其扩展性：声明一个队列将原子性的为每个实体组创建一个收件箱，给我们提供百万级别的终端。&lt;/p&gt;

&lt;h5 id=&quot;两阶段提交&quot;&gt;两阶段提交&lt;/h5&gt;

&lt;p&gt;Megastore支持两阶段提交对组间原子性的更新。因为这类事务拥有高得多的延迟并且增加了竞争的风险，我们并不鼓励用户使用这个功能，而是推荐其使用消息队列。但是，这可以简化开发代码。&lt;/p&gt;

&lt;h3 id=&quot;其他功能&quot;&gt;其他功能&lt;/h3&gt;

&lt;p&gt;全文索引支持、支持断点快照的备份系统、回退进场能够把一个实体组的状态回退到任意一个时间节点，并可选择的删除指定的日志入口（如意外删除以后）。加密数据和事务日志。&lt;/p&gt;

&lt;h1 id=&quot;复制-1&quot;&gt;复制&lt;/h1&gt;
&lt;p&gt;同步复制架构：一个对Paxos的低延迟的实现。具体细节。&lt;/p&gt;

&lt;h3 id=&quot;概览&quot;&gt;概览&lt;/h3&gt;
&lt;p&gt;Megastore复制系统提供一个单一、一致的存储数据的视图，基于其副本。读、写可以从任意副本开始，并且无论客户端从哪个副本开始，ACID语义都能够得到保证。每个实体组都有副本，通过同步复制该组的事务日志到一系列的副本上。写一般只需一轮数据中心间的通信，健康情况下，读在本地。当前读有如下保证：
&lt;img src=&quot;/assets/postsimg/mega-6.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;paxos的简要总结&quot;&gt;Paxos的简要总结&lt;/h3&gt;
&lt;p&gt;Paxos在一组副本之间对单一值达到一致性的一种方法。包容延迟的和乱序的消息以及因为停机导致的复制。但是大多数副本必须活跃且可达，要使算法生效的话。在2F+1个副本中，能够允许F个错误。一旦某个值被大多数所选取，将来的对该值得任意读和写将到达一致的结果。&lt;/p&gt;

&lt;p&gt;数据库一般是用Paxos来复制事务日志，其中每个Paxos的实例用于复制日志的每个position。新的值将基于最后一次选出的position来决定写入日志的position。&lt;/p&gt;

&lt;p&gt;原生算法不适用于高延迟网络连接，因为它需要多伦通信。 写需要至少两轮组间通信，一轮准备用于获取接下来一轮接受的权利。读需要至少一轮来决定上次被选的值。真实应用需要减少Paxos的轮数，来使之成为一个实际的算法。&lt;/p&gt;

&lt;h3 id=&quot;paxos原生基于主节点的算法&quot;&gt;Paxos原生基于主节点的算法&lt;/h3&gt;
&lt;p&gt;有主节点，总是最新状态，能不须网络通信即可读，写被缩减到一轮基于在每次accept后的对下一次写的准备。主节点能批量写用于提高吞吐量。&lt;/p&gt;

&lt;p&gt;依赖于主节点读和写。事务处理必须围绕主节点，来避免接下来读的累积延迟。任何可能的主节点必须用用充足的资源来承载系统的全部负载；从节点将浪费其资源知道其成为主节点。主节点的故障转移需要一个复杂的状态机，并且在服务重新启用是灰耗费大量时间。避免用户可见的中断是很难的。&lt;/p&gt;

&lt;h3 id=&quot;megastore对paxos的实现&quot;&gt;Megastore对Paxos的实现&lt;/h3&gt;

&lt;h5 id=&quot;快速读&quot;&gt;快速读&lt;/h5&gt;
&lt;p&gt;当前读应该经常在任意副本上都能够执行，不须副本间的远程调用（RPC）。因为写经常在所有副本上都能成功，所以允许在任意地点的本地读是实际的。本地读能够提供更好的利用率、低延迟、细粒度的读容错，以及一个简单的编程体验。&lt;/p&gt;

&lt;p&gt;我们设计了一个叫做Coordinator的服务，在每个副本的数据中心服务。调节器服务器追踪一系列的Paxos写已经被观察到的实体组。对该集长得任意实体组，副本有足够的状态来支持本地读。&lt;/p&gt;

&lt;p&gt;保持协调者的一致性是写算法的责任。如果对一个副本的写失败了，它就不能提交，直到它的key从该副本的协调者中移除。&lt;/p&gt;

&lt;p&gt;协调者非常的简单，所以更可靠、速度更快。&lt;/p&gt;

&lt;h5 id=&quot;快速写&quot;&gt;快速写&lt;/h5&gt;
&lt;p&gt;采用了在基于主节点的算法中的提前准备优化方式。Megastore不是用特定的主节点，而是使用头结点（leaders）。
&lt;img src=&quot;/assets/postsimg/mega-7.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;一个写操作必须在提交值个其他副本前与leader通信，我们最小化写操作和leader间的通信。我们才用的策略是，从应用提交写最多的区域选取写的leader。这是一种非常简单有效的启发式思想：选最近的副本。&lt;/p&gt;

&lt;h5 id=&quot;副本类型&quot;&gt;副本类型&lt;/h5&gt;
&lt;p&gt;至今为止的副本都是全副本，意味着它们包含所有的实体和索引数据并且能够支持当前读。我们也支持见证者副本。见证者参与Paxos的选举轮，并存储写前日志，但是不应用日志也不存实体数据和索引，所以它们的存储成本非常低。用于充人数。&lt;/p&gt;

&lt;p&gt;只读副本是见证者的相反，它们不参加选举，但是拥有所有数据的快照。在这些副本上的读能够保证在过去某个时间节点的一个一致性视图。对于能够忍受这种缺陷的的读，只读副本能够帮助在广泛的地理区域内传播数据，而不会影响写入延迟。&lt;/p&gt;

&lt;h3 id=&quot;架构&quot;&gt;架构&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;/assets/postsimg/mega-8.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;数据结构和算法&quot;&gt;数据结构和算法&lt;/h3&gt;

&lt;h5 id=&quot;副本日志&quot;&gt;副本日志&lt;/h5&gt;
&lt;p&gt;允许副本收到乱序提交。
&lt;img src=&quot;/assets/postsimg/mega-9.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/postsimg/mega-10.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;读&quot;&gt;读&lt;/h5&gt;
&lt;p&gt;&lt;img src=&quot;/assets/postsimg/mega-11.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;写&quot;&gt;写&lt;/h5&gt;
&lt;p&gt;执行完一次完整的读操作之后，下一个可用的日志位置、最后一次写操作的时间戳， 以及下一次的leader副本都知道了。在提交时刻所有的更新都被打包（Packaged)和提议 (Proposed)，同时还包含一个时间戳、下一次leader提名及下一个日志位置的共识值。如果该值赢得了分布式共识，它将应用到所有的副本中。否则整个事务将中止且从读操作重新开始。&lt;/p&gt;

&lt;p&gt;快速读时协调者的状态是由写算法来保证的。这实际上描述了这样的一个过程：如果一次写操作不是被所有的副本所接受，必须要将这些未接受写操作的副本中相关的实体组从协调者中移去，这个过程称为失效（Invalidation)。失效的过程 以保证协调者所看到的副本上数据都是接受了写操作的最新数据。在一次写操作被提交并准备生效之前，所有的副本必须选择接受或者在协调者中将有关的实体组进行失效。&lt;/p&gt;

&lt;p&gt;图是数据写入的完整过程，具体包括如下几个步骤。
&lt;img src=&quot;/assets/postsimg/mega-12.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;⑴接受leader请求leader接受值作为0号提议。这实际上就是前面介绍的快速写方法。如果成功，跳至步骤（3)。&lt;/p&gt;

&lt;p&gt;(2)准备：在所有的副本上使用一个比其当前所见的日志位置更高的提议号进行Paxos准备阶段。将值替换成拥有最高提议号的那个值。&lt;/p&gt;

&lt;p&gt;(3)接受：请求剩余的副本接受该值，如果大多数副本拒绝这个值，返回步骤（2)。&lt;/p&gt;

&lt;p&gt;(4)失效：将不接受值的副本上的协调者进行失效操作。&lt;/p&gt;

&lt;p&gt;(5)生效：将值的更新在尽可能多的副本上生效。如果选择的值和原来提议的有冲突，返回一个冲突错误。&lt;/p&gt;

&lt;h3 id=&quot;协调者可用性&quot;&gt;协调者可用性&lt;/h3&gt;
&lt;h5 id=&quot;故障探测&quot;&gt;故障探测&lt;/h5&gt;
&lt;h5 id=&quot;生效竞争&quot;&gt;生效竞争&lt;/h5&gt;

&lt;h3 id=&quot;写吞吐量&quot;&gt;写吞吐量&lt;/h3&gt;

&lt;h3 id=&quot;操作问题&quot;&gt;操作问题&lt;/h3&gt;

&lt;h3 id=&quot;产品度量&quot;&gt;产品度量&lt;/h3&gt;

&lt;h1 id=&quot;实验和相关工作&quot;&gt;实验和相关工作&lt;/h1&gt;

&lt;h1 id=&quot;总结&quot;&gt;总结&lt;/h1&gt;
&lt;p&gt;提出Megastore，一种可扩展的、高可用的数据库，用于满足交互型互联网服务的需求。我们使用Paxos算法进行同步宽域复制，提供轻量但快速的故障转移对独立的操作。使用Bigtable作为扩展存储，用来更多的支持ACID事务、索引、队列。将数据分片成实体组作为子数据库提供了很多事务性的功能，同时还提供了扩展性和吞吐量。&lt;/p&gt;

&lt;p&gt;Megastore现已有100多个应用在生产者，面临着内部和外部的用户，提供更高层级的基础架构。这些用用的数量和多样性证明了Megastore的易用性、普适性、和强大。&lt;/p&gt;
</description>
        <pubDate>Fri, 10 Aug 2018 18:32:20 +0800</pubDate>
        <link>http://localhost:4000/2018/08/Megastore-Providing-Scalable,-Highly-Available-Storage-for-Interactive-Services</link>
        <guid isPermaLink="true">http://localhost:4000/2018/08/Megastore-Providing-Scalable,-Highly-Available-Storage-for-Interactive-Services</guid>
        
        <category>论文阅读</category>
        
        <category>读书笔记</category>
        
        
      </item>
    
      <item>
        <title>Approximate Query Processing No Silver Bullet</title>
        <description>&lt;h1 id=&quot;摘要&quot;&gt;摘要&lt;/h1&gt;

&lt;p&gt;在这篇论文，我们对近似查询处理的最新技术进行综述。尽管在这一研究领域取得了很多技术进步，但我们尚未看到它对产品和服务的影响。我们讨论了将 近似查询处理集成到数据平台中的两种有希望的途径。&lt;/p&gt;

&lt;h1 id=&quot;1绪论&quot;&gt;1、绪论&lt;/h1&gt;

&lt;p&gt;虽然大数据打开了获得前所未有的洞察力的可能性，但其代价是对大量数据上的查询回答的计算资源（或更高延迟的风险）的需求增加。以传统方式执行查询代价的一部分，来提供近似查询的能力，使得我们能够更加高效地探索大数据集。特别地，这些技术能够有效地帮助数据科学家识别那些需要进一步挖掘、发现趋势、进一步可视化的数据的子集。在这篇文章中，我们关注基于采样技术的近似查询处理架构。&lt;/p&gt;

&lt;p&gt;一个近似查询处理系统架构能够通过以下一些特性来描述：支持的查询语言、错误模型和准确率保证、运行时工作量的减少以及其在预处理上所增加的额外开销。AQP框架的这些方面不是相互独立的，过去的大部分工作都在这四个方面作出了独特的选择。特别的是，想要构建一个丰富支持SQL的、节省大量工作量的、准确率高到能被大部分应用接受的AQP系统，几乎是不可能的。换句话说，鱼与熊掌不可兼得。&lt;/p&gt;

&lt;p&gt;如果真的没有银弹的话，那么人们就想问，AQP是否只是一个不可能的梦想（银弹喻指人们寄予厚望的某种新科技）。事实上，甚至在数十年的研究以后，AQP依然很大程度地限制在学术研究上，并且在今天的产品及服务上依然没有一个很好的范例。由于应用经常使用应用相关的近似，那么AQP的缺少实践不能视为应用对近似值不感兴趣的证据。相反，如果我们查看AQP的近况的话，我们会相信，尽管应用对近似值很感兴趣，近似处理层面的近似值对应用往往无效，因为AQP的误差模型和准确率以及AQP对于工作量的减少都不能够令人满意。&lt;/p&gt;

&lt;p&gt;我们坚信AQP议题的价值，插句题外话，在大数据的世界是非常的重要的。我们不应该放弃对类似系统的追求。然而，我们对AQP研究方法的重新思考是有必要的，其目标是使这些系统具有实用性。重新思考的第一步是，清晰的认识到，如何组合AQP的四个维度才能使得应用找到AQP系统的吸引人之处。在这篇文章中，基于我们的反思，我们建议两个值得探求的研究方向。&lt;/p&gt;

&lt;p&gt;一个有希望的方向可能是把对精准度的控制权割让给用户。这种方法基于承认AQP系统不会提前（在查询被AQP系统执行完之前）得到任意SQL查询的精确值的事实。在这种情况下，最好是为应用程序员配备语言原语，以帮助他们将近似值注入数据密集型计算中。最后，我们扩展我们的查询余姚到取样器上以使得应用程序员能够表达他们关于对特定程序精准度的语义。我们将把这种方法称为查询时取样并在section2讨论。为了保证程序员有足够强大的操作来在任意SQL查询中使用取样，需要奇特的取样器。比如selection，对一个关系取样能够使接下来的计算成本减少，由于数据量的减少。然而与selection不同，叠加采样器并不总是可行的。因此，引进新的采样器，引进了奇特的基于成本的查询优化挑战–在保证取样器的语义的等价的的一些计划中识别出性能最好的计划。性能的获得依赖于查询计划中取样器的深入程度以及物理访问方法的可用性。注意到这种方式给予程序员在应用中使用关系型语言（SQL及其变种）的全部能力。&lt;/p&gt;

&lt;p&gt;我们发现的第二个吸引人的方向是，AQP系统承诺任意到达的查询一个查询无关的精确度的保证。这样一个约定保证了一个统一的方式使得AQP系统对探究性的查询倾斜而不是担心每个查询潜在得不同数量的错误。此时，我们仅能够提供对OLAP形式的查询的支持，而不是所有的SQL，也仅支持一些错误度量值。我们将在section3讨论该部分。关键的直觉是除了使用预先计算的样本之外，还以巧妙的方式（例如，仅针对小的分组）利用索引。与先前几种后验精确度估计（如基于样本算置信区间）的技术不同，我们将展示这些方法如何提供一个前置错误边界。&lt;/p&gt;

&lt;p&gt;AQP的工作体量太大，我们不可能一下子全部总结完。因此，我们仅讨论上述两个方向相关的工作，并在section4回顾一些开放性问题。除上述两个方向上的一些技术进步外（以及其他的一些为应用提供了一个清晰的价值议题的算法），更多工作需要做从而使得AQP成为现实。为了提升用户接受度，我们相信在实际的数据平台上实现AQP至关重要。考虑在决策支持查询之下的新的用户场景，以及问自己，近似查询处理如何才能有价值也很重要。这两个议题将在section5进行讨论。&lt;/p&gt;

&lt;h1 id=&quot;2查询时采样-query-time-sampling&quot;&gt;2、查询时采样 QUERY-TIME SAMPLING&lt;/h1&gt;

&lt;p&gt;在查询时采样中，用户明确指定查询中的取样器操作。SQL：2008标准的语法让用户选择取样器的类型、取样比例以及可选择的其他取样器参数。一个查询优化器可以考虑取样器作为计划中的逻辑运算符，并且能选择合适的物理实现（比如水库抽样、从索引中抽样），从基于成本的方式。每个取样运算符有明确的语义，并且查询的输出能够精确地反映用户的说明。查询时取样的工作从[71,75]开始有着丰富的历史。这样取样的优点是，取样器之下的操作能够执行的更快或使用更少的资源。然而，注意到这种方式中，查询执行层只知道如何忠实的执行取样器运算符。对一般的SQL查询，查询系统不会提供统计学精确度保证。早期的工作[71]关注一种取样器运算符，它能够以给定的概率随机均匀选取输入行。许多数据库及大数据系统支持该种均匀抽样运算符。在线聚合方法也是均匀取样。然而，这样做导致了一个更大的挑战，我们将在2.3讨论。我们从讨论均匀取样运算符的几个严重限制开始，这些限制妨碍其通用使用，并以此引进新的取样运算符。&lt;/p&gt;

&lt;h3 id=&quot;21-均匀抽样之下--beyond-uniform-sampling&quot;&gt;2.1 均匀抽样之下  Beyond Uniform Sampling&lt;/h3&gt;

&lt;p&gt;对于用户来说，想把取样器深入的插入他们的查询中（比如在一个join或一个selection之前）是很自然的，因为这样做能够节省大量的运行时工作。&lt;/p&gt;

&lt;p&gt;分组和谓词：考虑在一个关系R的均匀抽样之下执行下列查询
SELECT ZipCode, AVG(Salary) FROM R GROUP BY ZipCode&lt;/p&gt;

&lt;p&gt;均匀抽样可能会完全的丢掉某些小的组，或抽取太少样本导致对较小组的平均值估计不准确。类似的问题同样在带有谓词的查询中出现：
SELECT COUNT(∗) FROM R WHERE  County = ‘SanJuan’
当其执行在一个均匀抽样之上。均匀抽样可能会在该谓词上一行也抽不到，或抽取的行数太少以致答案不准确。&lt;/p&gt;

&lt;p&gt;一个标准的对上述问题的解决办法是进行有偏抽样对小的分组及满足谓词的行。类似采样的一个运算公式是 distinct sampler：给定参数C,f,p,distinct sampler对列集合C中每个不同的值至少提取f行，并且所有行都能够以至少为p的概率被选取。一个在group-by或谓词列集合之上的distinct sampler将对每个属性列的值产生至少f行样本。&lt;/p&gt;

&lt;p&gt;因为区分取样在一个查询流水线中运行时执行，与一般统计学取样的情况不同，区分取样有一些严格的实现要求。任意取样器运算符的理想属性包括一次性完成数据，具有较小的存储器占用空间，并且在运行时不需要在数据分区上并行操作的任务之间进行协调。最近的一篇文章展示了如何完成上述三个属性。&lt;/p&gt;

&lt;p&gt;Joins：在典型的数据库系统和大数据系统中，数据在多张表之间传播。因为join的成本比较高，确认先取样后连接能否与先连接后取样有相同的精确度就很有必要了。如果可能的话，那么join可以在取样后进行。&lt;/p&gt;

&lt;p&gt;大多数方法只支持多对一的等值连接；如键 外键或多重类似连接在一个star型架构中。在类似连接中，有一张实际表，实际表中的每一行与来自其他维度的表的至多一行匹配（与维度表中谓词同时出现）。因此，这种连接在更宽的行集上镜像谓词。正如上面关于谓词的情况所讨论的，连接列上的事实表的不同样本可以满足这种连接。&lt;/p&gt;

&lt;p&gt;对于多对多等值连接，对连接输入进行均匀采样会导致性能和准确性不佳。 当多个输入很大时，仅采样一个输入的性能改善很小。 观察到对于连接输出上的期望采样分数，在连接输入上按下均匀随机采样不是高效的，因为每个连接输入上的采样分数通常需要比连接输出上的期望采样分数大得多。 此外，由于一个输入中的行可以与另一个输入中的多个行匹配，因此获得连接结果的均匀样本还要求每个输入中的行基于它们在其他表中匹配的频率进行采样。 已经提出的用于支持这种相关采样的技术的适用性不会扩展到一般查询，例如当连接的输入是嵌套的SQL语句时。&lt;/p&gt;

&lt;p&gt;我们现在考虑哪种采样运算符可以帮助我们有效地对连接采样输入（即，下推采样操作）以获得连接输出的样本。 我们对Universe采样器的建议满足了这一需求。 Universe采样器是均匀采样器的略微松弛，并且具有更高的方差，但在许多实际情况下是吸引人的。 给定参数C，p，Universe采样器随机均匀地选取列集C的值的p分数并输出具有这些值的所有行。 如果多个连接输入在连接列上应用相同的Universe采样器，即它们选择连接列的相同随机值，则universe-sample-then-join与join-then-universe-sample相同。再次注意，连接输出的Universe样本不是均匀随机样本; 它具有更高的方差，可以精确量化。 但是，不仅可以将Universe采样器向下推到连接的输入，它还具有高性能，因为只需要一小部分输入样本来实现连接输出的p分数样本。 早先使用类似的想法估计文档相似性[20]，估计连接基数[81]和清理陈旧观点[62]; 然而，Universe采样器可以更广泛地用于采样一般查询[60]。&lt;/p&gt;

&lt;h3 id=&quot;22-取样器上的查询优化-query-optimization-over-samplers&quot;&gt;2.2 取样器上的查询优化 Query Optimization over Samplers&lt;/h3&gt;

&lt;p&gt;虽然可以根据用户的需要插入上述采样器运算符，但是当这些运算符在计划中深入执行时（例如，连接输入上的Universe采样器而不是对连接输出进行采样），可以获得大的性能提升。 因此，一个自然要问的问题是给定一个用户指定采样器的查询，我们是否可以自动生成更高效的计划，同时保持准确性？&lt;/p&gt;

&lt;p&gt;假设采样器被指定为表值函数。 考虑以下重要的查询子表达式类，其中用户计算采样关系上的分组聚合。&lt;/p&gt;

&lt;p&gt;SELECT C, Agg 1 , . . . , Agg n
FROM R SAMPLE &lt;samplertype&gt; &lt;samplerparams&gt;
GROUP BY C&lt;/samplerparams&gt;&lt;/samplertype&gt;&lt;/p&gt;

&lt;p&gt;这里，C是一组列，Agg i是类似SUM的聚合，最重要的是R可以是由例如嵌套的SQL语句组成的任何通用关系表达式。 请注意，这类查询子表达式比许多AQP技术所支持的要广泛得多。&lt;/p&gt;

&lt;p&gt;对于上述类中的任何查询子表达式，如果满足以下条件，则称查询计划转换规则保持准确性：
（1）查询答案中的每个组具有出现在两个计划中的相同可能性。
（2）每个组的总量估计值在两个计划中具有相同的预期值。
（3）转换规则产生的计划与总计估计值的差异不大（与转换前的计划相比）。&lt;/p&gt;

&lt;p&gt;对于上述类的查询子表达式，最近的工作表明查询优化器可以提供更高性能的计划，同时提供与用户指定的查询相同的精度[59]。 我们简要介绍下面的方法。&lt;/p&gt;

&lt;p&gt;如果仅支持统一采样器，则很容易证明在将采样器推到选择，投影和外键等值线中的事实表之下时，精度得以保留; 几个先前的方法隐含地使用这个属性[10,11]。 如果采样器被推到基表，它们也可以利用物理访问方法（例如，索引，柱状布局）[71]。&lt;/p&gt;

&lt;p&gt;但是，当有多个采样器可用时，与查询优化器的交互更有趣。 以下TPC-DS样式查询说明了采样器之间的交互如何帮助下推。&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt; &lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;COUNT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DISTINCT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;customer_sk&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;store_sales&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;store_returns&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ss_customer_sk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sr_customer_sk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SAMPLE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;UNIFORM&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;上述语法意味着要在采样关系上计算COUNT（*）。 由于连接不是关键的外键连接，因此在连接下方推动统一采样器会导致较大的错误（参见§2.1和[34]）。 但是，customer_sk上的10％Universe采样器与统一采样器具有相同的精度。 由于SELECT DISTINCT，我们知道customer_sk的每个不同值恰好在采样器的输入中出现一次。 因此，宇宙采样器在随机均匀地选择10％的customer_sk的不同值在统计上与统一采样器相同，均匀采样器随机均匀地选取10％的行。 现在，可以将Universe采样器推到equi-join下方。这样做可以大大降低成本，尤其是在分发连接时。 宇宙采样器还可以在每个关系中进一步向下推，超过选择，投影，外键等值连接和customer_sk上的任何等值连接; 所有这些都可以进一步降低成本。&lt;/p&gt;

&lt;p&gt;为了便于采样器下推，如上例所述，我们需要确定一组本地保持准确性的查询转换规则。 但是，在许多重要的情况下，是否按照数据集推送保留精度的采样器是否会改善计划成本，就像在传统的查询优化中一样。 此外，还有大量的替代计划。 因此，在QO的背景下进行基于成本的探索是恰当的。 以下TPC-DS样式查询说明了这些方面。&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i_color&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;SUM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ss_sales&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;store_sales&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ss_item_sk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i_item_sk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SAMPLE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DISTINCT&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i_color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;这里，用户可能已经使用了不同的采样器来确保每组将采样至少30行（i_color的不同值）。 列ss_item_sk是外键，store_sales比item表大得多。 因此，将采样器推送到store_sales可以提高性能。 但是，由于i_color列没有出现在store_sales中，因此这种下推似乎是不可能的。 但请注意，i_color在功能上依赖于连接列ss_item_sk; 因此将不同的采样器{/{ss_item_sk/}，30％，10％}推送到store_sales上将保持准确性。 然而，这种下推是否提高了性能取决于ss_item_sk的不同值相对于i_color的不同值的数量的数量。 由于前者较大，因此在连接下方推动采样器的增益可能会被较大的样本量所抵消。 因此，需要基于成本的优化来选择适当的计划。&lt;/p&gt;

&lt;p&gt;受上述例子的启发，最近的一项工作考虑了查询优化器中采样器之间的相互作用[59]。 它提供了几个本地保持准确性的采样器下推规则。使用这些规则，QO以典型的基于成本的方式探索了许多替代计划。 需要注意的一点是，统一采样器之外的新闻采样器为新的计划转换规则提供了机会; 使用这些规则，QO可以使采样器更深入地进入查询计划，同时保持准确性。 当然，性能提升的程度取决于采样器在查询计划中的深度。&lt;/p&gt;

&lt;h3 id=&quot;23-在线聚合&quot;&gt;2.3 在线聚合&lt;/h3&gt;

&lt;p&gt;在线聚合是我们上面讨论的查询时间采样方法的一种重要替代方法。 在线聚合方法逐步对输入的前缀执行查询; 它们将结果呈现给用户并在处理更多输入时更新结果。 假设每个前缀是整个输入的统一随机样本，可以为某些查询提供聚合的置信区间。 随着处理更多输入行，置信区间缩小。 在线聚合的关键优势在于用户可以快速收到大致的答案，并且可以在置信水平令人满意时终止查询。&lt;/p&gt;

&lt;p&gt;虽然在线聚合具有吸引人的价值主张，但与第2.1节和第2.2节中描述的基于采样器的技术不同，在线聚合需要更多的工作才能集成到现有的数据平台中。首先，他们需要满足条件的物理访问方法，即输入的每个前缀是一个统一的随机样本。如果没有这种支持，随机访问表的I / O成本会很高。维持输入的每个前缀的随机变量的随机样本作为数据演变的不变量也具有挑战性。一些工作解决了物理设计问题[55,56,76]。接下来，在线聚合需要特殊的操作符实现来支持渐进式执行（例如，ripplejoin）[50,57,64]。 Ripple join [50]是一系列运算符，它们可以积极地计算连接，但它需要连接的输入才能保持存储效率。 SMSjoin [54]放宽了这个限制，它将整个连接分成多个rip-ple连接的并集，每个连接都计算在内存中保证输入的部分输入的连接。 DBO系统[57]进一步提高了连接操作员的效率，并展示了如何在输入上控制索引。 WanderJoin [64]将指数用于极值;它表明，给定适当的索引，从输入连接各行的随机步行方法可以产生连接输出的随机样本。但是，这些索引的创建成本可能很高。&lt;/p&gt;

&lt;h1 id=&quot;3accuracy-guarantees-using-precomputed-samples&quot;&gt;3、ACCURACY GUARANTEES USING PRECOMPUTED SAMPLES&lt;/h1&gt;

&lt;p&gt;与第2节中介绍的查询时间采样技术相比，为了更快地缩短响应时间，我们可以在预处理步骤中从数据中提取样本并使用它们来处理传入的查询。 这种直觉几乎不新颖。事实上，基于这一思想开发了很多工作，例如，[11,10,31,17,32,33,72,79,13]。 可以绘制来自数据行的随机样本，并将其实现为数据库中的样本表。 这些预先计算的“小”样本表用于传入查询，从而显着减少查询的运行时间。&lt;/p&gt;

&lt;p&gt;如导言中所述，没有银子弹。 实际上，基于预先计算的样本的AQP系统专注于SQL查询的子类。 此类中的查询是一个SQL查询，它包含一个或多个列上的聚合，以及谓词，agroup-by运算符和可能的外键连接。 但是，这种聚合查询在OLAP和许多商业智能应用程序中非常常见且非常重要。&lt;/p&gt;

&lt;p&gt;尽管基于预先计算的样本的AQP系统提供低延迟，但是主要缺点是这样的系统通常不提供先验精度保证。 尽管对这些系统所要求的预计算进行了大量投资，但这种缺乏使查询此类系统“命中或错过”。&lt;/p&gt;

&lt;p&gt;在3.1节中，我们回顾了一些代表性的过去工作的例子。 在3.2节中，我们回顾了这些系统提供的准确性模型，并解释了为什么它们不足。 在3.3节中，讨论了我们认为有前景的方法 - 使用预先计算的样本以与查询无关的方式提供准确性保证的能力。&lt;/p&gt;

&lt;h3 id=&quot;31-choosing-samples-in-pre-processing&quot;&gt;3.1 Choosing Samples in Pre-processing&lt;/h3&gt;

&lt;p&gt;预处理和查询时间成本与答案的准确性之间存在权衡。 如何选择样本以及样本表的大小都是该技术在减少查询运行时间方面的准确性和有效性的关键因素。 确定选择包含在样本表中的元组的标准具有挑战性。 考虑带有谓词的临时查询。 可能是在样本表被谓词过滤后，我们可能没有足够多的样本行来准确估计查询的答案。 理想情况下，我们的目标是确保在样本表中评估传入查询中的谓词并执行group-by之后，每个组中保留足够多的样本行，以便估计的答案具有足够小的错误。 类似地，对诸如SUM（A）的聚合的估计的准确性对属性A的异常值是否在样本中是敏感的。&lt;/p&gt;

&lt;p&gt;受统计学中的分层抽样技术[65]的启发，AQP系统校准表格不同部分的抽样分数，以创建样本来应对这一挑战。在一些AQP系统中，这种校准完全基于表的模式和统计（工作负载无关），例如[11,10,31,17]。这一工作线由AQUA系统启动[11,10] ，它考虑了分组列的所有可能组合，并为每个组合选择不同的采样分数。还有另一项工作利用历史工作负载分配（工作负载感知），例如[32,33,72,79,13]，假设未来的工作负载与之相同，或者至少具有类似的分布。过去的。例如，在[46]中使用工作负载来构建有偏差的样本。 STRAT [32,33]旨在最小化查询工作负载的预期相对误差。我们现在详细讨论一个用于创建样本表的工作负载独立和工作负载感知技术的示例。&lt;/p&gt;

&lt;p&gt;Babcock等人。 [17]提出了小组抽样，一种分层抽样技术，在每一列上构建全局统一样本和偏差样本。 统一抽样在为聚合查询中的大组提供良好估计方面做得很好。 为了提高小组聚合的准确性，对于每列，在列中包含不常值的行包含在有偏差的样本中。 在统一样本和所有偏置样本的并集上执行查询，其中列出现在查询中以估计答案。 这种方法的缺点在于，在实际工作负载中，小组可能由两个或更多列上的约束的交叉所引起，这些约束不能被上述偏置样本集捕获。&lt;/p&gt;

&lt;p&gt;BlinkDB [14,13]是一个代表性的工作负载感知AQP系统，如果这些组合（或部分组合）在工作负载中很常见，它可以处理多个列上的小组。 它首先将工作负载信息抽象到查询中出现的一组列（称为QCS），以便它可以对工作负载分布进行有意义的估计。 对于每个可能的QCS，它可以创建一个分层样本 - 在Babcock等人的文章中可以找到类似的分层样本。[17]。 但由于创建和维护所有QCS的分层样本太昂贵，BlinkDB制定了一个优化问题，以决定如何根据以前的工作负载为不同QCS的样本分配空间预算，从而最大限度地减少整个工作负载分布的样本损失。&lt;/p&gt;

&lt;p&gt;工作负载感知AQP系统固有的缺点是工作负载可能会不断变化[67]，尤其是对于AQP最有益的探索性工作负载。 在这些系统中，检测工作负荷分布变化和重新优化样品可能是一项昂贵的重复任务。&lt;/p&gt;

&lt;p&gt;构建样本表时的另一个目标是确保捕获聚合列上具有不同值的thatrows，如本小节开头所述。 [31]中提出的异常值索引存储每列中具有异常值的行。 它与均匀随机样本一起使用以产生无差异的估计，同时减少SUM和AVG的方差。&lt;/p&gt;

&lt;h3 id=&quot;32-lack-of-a-priori-accuracy-guarantees&quot;&gt;3.2 Lack of A Priori Accuracy Guarantees&lt;/h3&gt;

&lt;p&gt;当针对预先计算的样本回答查询时，AQP系统在答案中提供估计的错误是重要的。 有几种方法可以测量以前系统中的错误。 例如，在[11,13]中使用置信区间（CI）。具有90％置信水平的CI = [est-w，est + w]意味着非正式地具有90％（预采样）概率， CI涵盖了真正的答案，其中est是一个组的估计答案[65]。平方误差是[32,17]中使用的另一个误差模型。 Boot-strap [85]用于在答案中提供更严格的错误估计。&lt;/p&gt;

&lt;p&gt;无论使用上述哪种错误模型，先前系统的准确性合同中的一个常见问题是它们仅在处理查询后才对错误进行判断，但不能保证错误低于预先规定的阈值。提前做好了。我们以基于CI的错误模型为例。它们可以轻松支持广泛的样本输入和复杂查询。使用例如中心极限定理（CLT）或Hoeffding不等式[47]来计算CI，并且还可以支持不同的聚合函数。但是，CI与数据有关。即，当列A上的值具有大的标准偏差或大的范围MAX（A）-MIN（A）时，具有聚合SUM（A）的查询的结果CI可能比较大。对于使用预先计算的样本的AQP系统来说，这是一个关键问题：在预处理之后使用样本表的大小，错误或CI可以是传入查询的小或大。因此，该系统的有效性是“命中或关闭”。&lt;/p&gt;

&lt;h3 id=&quot;33-aqp-with-query-independent-accuracyguarantee&quot;&gt;3.3 AQP with Query-Independent AccuracyGuarantee&lt;/h3&gt;

&lt;p&gt;据我们所知，基于预先计算的样本（包括第3.1节中讨论的那些）的所有先前的AQP系统成功地估计了即时查询的错误，并且在每个传入查询的边界错误（≤ ）中有后验错误。 支持的查询类先验。 为每个查询绑定AQPystem错误的能力使得这样的AQP系统更具吸引力。 在这样的系统上询问查询然后将具有服务级别协议，并且不再显示为“命中或未命中”体验。&lt;/p&gt;

&lt;p&gt;对于所有不同的聚合门和误差模型，不能实现这种强有力的保证。 我们将重点关注使用SUM作为聚合函数的查询，以说明先前的方法如何在提供此保证时失败，以及最近的工作Sample + Seek [39]中的关键创新，即为聚合查询的子类提供与查询无关的准确性保证。 以下面的简单查询为例。&lt;/p&gt;

&lt;p&gt;SELECT B, SUM(A) FROM T
WHERE C = 10
GROUP BY B&lt;/p&gt;

&lt;p&gt;•需要更好的抽样策略。 如果谓词“WHERE C = 10”不是选择性的，即T中的大量行满足它，那么先前的方法如Babcock等人。 [17]和BlinkDB [13]主要依靠均匀随机样本来估计SUM（A）foreach组。 由于每行在样本中具有相同的概率，如果Ais上的分布偏斜，则估计具有大的方差（误差）。 两种方法都可以估计误差，但是对于固定的样本大小，误差可以任意大。&lt;/p&gt;

&lt;p&gt;Sample + Seek中采用的采样策略的核心思想是突然出现一个概率与其在A列上的值成比例的行。直觉是，具有接近A的平均值的行可以以比异常值更低的概率被挑选而没有更大的 对SUM（A）的估计结果的影响。 这种策略可以被认为是异常值索引的随机化版本[31]，具有最佳的准确性保证。 它还概括了[9]中COUNT的均匀采样的准确性分析。&lt;/p&gt;

&lt;p&gt;•需要索引的帮助。如果谓词“WHERE C = 10”是选​​择性的，即T中只有几行满足它，则全局randomsample不满足，因为它可能不包含这些行。 我们不需要提前估算选择性。相反，我们渠道用预先计算的样本irst处理查询;如果没有足够多的样本行满足谓词，请在[39]中向索引求助。请注意，这些索引可以在大多数数据平台中使用索引的传统实现。这些指示以两种方式使用。在一种方式中，一维索引可以用于检索满足“C = 10”的所有行 - 因为只有少数这样的行，我们可以扫描它们以获得精确的结果。我们将这些指数称为低频指数。此外，anindex可以用于检索行满足“C = 10”的ID的随机样本，其具有行的ID出现在该样本中的特性，其概率与其在A上的值成比例。为了绘制该样本用于多列上的谓词，我们需要计算多个一维指数的索引交集;但是，我们只需要索引交集结果的预测 - 索引可以这样构建，即preix为我们提供了所需的行ID样本。仅对于此小样本中的行ID，我们需要执行索引查找以查找列A和B上的行的值，以便估计每个组的SUM（A）。&lt;/p&gt;

&lt;p&gt;Babcock等人的偏见样本。 [17]也可以在上面的第一种方式中使用，但它们不能处理两个或多个列上的选择性谓词，例如“C = 10 AND D = 20”，具有相同的准确性。 BlinkDB [13]中QCS上的分层样本可以处理多个列上的选择性谓词，但存储约束可能会限制可以有效支持的多维QCS的数量。&lt;/p&gt;

&lt;p&gt;•可以提供准确性保证。 Sample + Seek中的样品和样品用指数仔细校准，它们可以无缝地覆盖选择性和非选择性查询。 对于COUNT和SUM，Sample + Seek可以在分布精度方面提供与查询无关的准确性保证：即，我们可以对精确和估计的通道进行标准化，使得所有组的标准化值总和为1，并且 分配误差被定义为两个归一化答案之间的L 2距离。 例如，假设示例查询的确切an-swer是x = h69,31i，B上有两个组，并且提供了估计答案x = h70,32i; x中的分布误差isp（69/100 - 70/102））2+（31/100 - 32/102）2≈0.005。 对于受支持类中的任何查询，保证估计答案中的分布误差总是不超过预先指定的误差阈值 ，具有高概率。&lt;/p&gt;

&lt;p&gt;可以参考[39]关于如何支持不同类型的预测，例如，多列上的范围约束，以及跨表的外键连接。 还讨论了准确性保证如何推广其他聚合，例如AVG和STD。&lt;/p&gt;

&lt;p&gt;将其他误差模型的强精度保证推广到一个开放的问题，例如均方误差。 具有准确性保证的AQP问题的形式化可以如下优化：对于数据库中的用户给定的错误阈值，，预先计算样本和索引，其总大小是数据库大小的函数，支持的查询类，集合 columnsin聚合和谓词，以及错误阈值 ; 这样系统可以确保支持类中的任何传入查询都可以使用预先计算的样本和索引来回答，其中错误最多为 ，概率很高。&lt;/p&gt;

&lt;h3 id=&quot;34-comparison-with-query-time-sampling&quot;&gt;3.4 Comparison with Query-Time Sampling&lt;/h3&gt;

&lt;p&gt;与查询时间采样技术相比，基于预先计算的样本的AQP技术实现了响应时间的急剧减少，但是仅限于聚合查询的子类（单块并且仅具有关键的外键连接）。如果分发准确性的概念对于用户来说是令人满意的，则上述的Sample + Seek以独立于查询的方式提供严格且先验的准确性保证。但是，这样的保证需要支持预先计算的样本表和插入。维护各种样本和指示（特别是对于不同的聚合函数和多个聚合列）的累积成本可能导致大量的预计算（和维护）开销。考虑到这种开销，能够压缩这些样本和索引以减少存储开销，同时保持运行时效率是一项技术挑战。另请注意，较大的容错有助于减少这种开销。如果工作负载分布不可预测，Sample + Seek以及以与工作负载无关的方式优化样本的其他方法（例如，Babcock等人[17]）会更好。如果工作负载分布是静态的并且列数不大，则基于历史工作负载优化样本的系统（例如，BlinkDB [14,13]）可能是一个很好的选择。&lt;/p&gt;

&lt;p&gt;相比之下，使用§2.1和§2.2中描述的方法的查询时采样不需要预先计算或维护样本表的开销（以及Sample + Seek的索引）。并且，如果查询可以具有嵌套的SQL语句或非关键外键等值连接的连接，则不能使用当前基于预计算的技术，并且查询时间采样仍然是唯一的选择。但是，查询时采样可能具有较小的性能增益，除非采样器可以深入到查询计划中，并且除非在采样器操作符被推送到那些基表时基表上存在物理访问方法。此外，与Sample + Seek不同，查询级别不提供准确性保证。查询时间采样还可以最无缝地与现有数据平台混合，并且可以使用可扩展性机制添加其他采样运算符。但是，在线聚合（查询时采样的变体）具有更高的与现有数据平台集成的工程成本。&lt;/p&gt;

&lt;h1 id=&quot;4related-work&quot;&gt;4、RELATED WORK&lt;/h1&gt;

&lt;p&gt;在近似查询处理中有如此庞大的工作量。 实际上，对近似查询处理的更广泛的定义还可以包括诸如实体匹配和重复复制之类的技术。 但是，在本文中（以及本节中关于相关工作），我们只考虑从回答查询的角度进行近似查询处理，显着减少工作或延迟，估计答案中的误差很小。&lt;/p&gt;

&lt;p&gt;SnappyData [78,5]支持流式，事务性和交互式系统中的近似答案。 它重用了BlinkDB [13]中的许多内容，并在[68]中总结了一些经验教训。 Spark-SQL [6]支持在线聚合和所谓的delta updatequeries以及基于bootstrap的错误界限[84]。 除了这些实例之外，近似查询处理还没有在数据平台中得到广泛应用。&lt;/p&gt;

&lt;p&gt;虽然一些研究工作考虑了采样过度流中的问题[19,36,18]，但采样器操作员并没有得到良好支持的语音引擎（例如，Trill [27]，Spark Streaming [83]）具有可启动的异常[5]，如上所述。 采样可能有所帮助 - 因为这些引擎受内存限制，并且与草图不同，示例可以支持更一般的查询。&lt;/p&gt;

&lt;p&gt;就先验的错误保证而言，只有COUNT可以由统一或分层的样本支持。 使用测量偏差采样器[39]支持SUM，AVG和STD，GEE [29]可以支持DISTINCT COUNT。 事后可以提供误差的后验估计; 对于COUNT，SUM，AVG和STD以及任何广义单形采样器，可以计算基于后验方差的边界和尾部概率边界[70]; 对于不同的和宇宙采样器也可以提供类似的支持。 处理聚合的随机算术表达式和用户定义的函数一般来说更具挑战性，并且许多问题仍未解决。&lt;/p&gt;

&lt;p&gt;为了支持准确性延迟权衡，BlinkDB [13]使用错误延迟证明（ELP）在多个预先计算的样本中进行选择。 查询的ELP记录在样本上执行查询时观察到的准确性和延迟; 它是通过对所有预先计算的样本执行查询来构造的。 他们面临的主要挑战是：当一个新的查询以准确性和性能目标到达时，如何咨询ELP以获得适当的样本（如果有的话）？ 在查询时间采样的上下文中，可以应用采样器下推规则，在本地权衡小的降级精度以获得更好的性能[59]。&lt;/p&gt;

&lt;p&gt;为了提高查询优化器内部的成本，样本用于快速估计查询子表达式的基数[81,63,41]。 基数估计类似于没有组的COUNT查询。 因此，即使这些技术与AQP相关，也不要概括为查询答案。&lt;/p&gt;

&lt;p&gt;Nirkhiwale等。 [70]展示了如何计算类似SUM的聚合的无偏估计和估计的方差，用于具有多个广义均匀采样器（GUS）算子的计划。 关键的想法是将计划与任意多个采样器转换为在聚合门之前具有单个GUS运算符的新计划，使得两个计划是等效的。 这种转换有助于推导出无偏估计的闭合形式表达式和估计量的方差。 上述见解在[60] toconsider运算符中得到了扩展，这些运算符不是GUS（例如，§2.1中的不同和Universe采样器），并且可以分析丢失组的可能性。对于其他采样器来说，扩展这种分析方法仍然是一个悬而未决的问题（例如， 非GUS，不是明显的而不是宇宙）。 或者，可以在样本上使用自举算子来估计计划精度[12,85,84]。&lt;/p&gt;

&lt;p&gt;在本节的其余部分，我们将讨论其他近似查询处理的方法。查看实现[52,15,49]技术预先计算了一些查询的答案，并创建了summariesto，以准确地加速OLAP和决策支持查询（没有近似）。几个引擎使用这些技术的子集[1,8,7]。许多努力减少了高维数据上数据立方体的大小;参见[51]进行调查。类似地，直方图[48]，小波[82,26,48]和草图（下面讨论）可用于近似计算一些聚合;见[47]和[38]这些技术的总结。直觉是，thesedata结构充当原始数据的概要，并且可以大致回答查询的子类。它们的关键优势在于，对于某些查询，这些技术可以为基于采样的系统提供更好的答案（例如，精确或具有小变化的估计）。常见的缺点是它们不能支持一般查询;对于高维数据集而言，它们具有较大的空间开销，并且空间开销变得更大，以支持选择和分组。&lt;/p&gt;

&lt;p&gt;草图是一种特定类型的数据概要[38,40,45]，它们对数据流处理产生了巨大影响[69]。 草图特定于特定聚合，并且可以在一个逾越节数据中计算。 一旦计算出来，草图就可以回答相应聚合的查询而无需检查原始输入。因为草图在信息丢失成本方面获得了紧凑性和计算效率，所以在为一个聚合或谓词构建草图之后，草图不能用于支持 查询其他聚合或谓词。&lt;/p&gt;

&lt;p&gt;另一项工作[44,43,24,42,22]通过在应用程序引发的基数约束上构建的索引的帮助下，仅通过访问有限数量的数据行来回答特定类型的查询。 BEAS系统[23]对AQP使用了类似的想法。最近的工作[77]提出了一种确定性的近似查询方案。 它使用新颖的位片索引并评估对所有行的前几位的查询作为近似值。 需要研究这种应用方法的有效性。&lt;/p&gt;

&lt;h1 id=&quot;5-where-to-go-from-here&quot;&gt;5、 WHERE TO GO FROM HERE?&lt;/h1&gt;

&lt;p&gt;正如引言中所提到的，尽管有很多技术进步，但近似查询处理还没有成为主流。作为一个社区，我们可以继续进行更多的技术进步，但是在我们看来，我们应该暂停并扪心自问它将使得近似的查询处理成为现实。在本文中，我们认为没有银弹。换句话说，似乎没有单一的技术挑战，解决哪些技术可以实现近似查询处理的潜力。我们认为我们必须问自己，我们可以为一个近似的查询处理系统的用户提供什么明确的价值主张？基于该分析，我们提出了一个双管齐下的方法。一方面，我们应该为应用程序编程器配备查询语言中的重要原语，以便他们可以编写应用程序逻辑来执行应用程序特定的近似。这激发了我们在查询时间采样方面的工作（§2）。另一方面，对于受限制的查询语言，但是适用于商业智能和OLAP查询的查询语言，我们可以使用预先计算的样本和索引（§3）以与查询无关的方式提供准确性保证。通过大幅减少时查询的延迟以及准确性保证，数据分析师可以采用一种新方式与系统进行数据探索查询交互。除了这两种方法之外，我们作为一个社区需要预见替代方案，其中近似查询处理可以为用户提供高价值。&lt;/p&gt;

&lt;p&gt;除了为上面讨论的近似查询处理寻求明确的价值主张外，我们还提供以下建议：&lt;/p&gt;

&lt;p&gt;将AQP与数据平台集成：可轻松应用于现有数据平台的AQP技术将能够在引擎改进（如矢量化，colum-nar布局和架构趋势）上实现。通过与数据平台的集成，AQP技术将有更大的机会覆盖广泛的用户群。相比之下，独立系统在性能和在广泛使用之前对查询功能的必要支持方面必须满足非常高的标准。数据湖或数据仓库系统为AQP提供了特别有希望的机会。因为在这样的平台上的查询会消耗大量的集群时间（例如，通过点击日志或爬行日志或集群日志记录日志分析管道），即使查询时间采样提供了相对较小的成本降低（例如，50％） ），这些节省的绝对值可能很大。此外，预先计算的样本可用于支持数据库系统中的大型数据集的交互模式;即使查询空间受到限制，用户也可能被低延迟响应和准确性保证所吸引。&lt;/p&gt;

&lt;p&gt;查询的近似执行模式：为查询提供近似模式，特别是对于交互式查询，将提供一种有效的方法来安全地试验AQP系统的有效性，从而随着时间的推移克服对接受近似答案的抵抗。我们设想了一种实验模式，每当数据分析师提交即时查询时，系统将同时使用AQP system计算真实答案和答案。如果AQP技术可以快速响应，则结果可以呈现为快速但不精确的全息预览，邀请用户提供两个响应之一：“继续回答完整查询”或“取消完整查询”。这样的设置将允许我们通过获得隐含的用户反馈来更好地评估AQP系统的有效性。理想情况下，这种模式可以针对更有可能受益的查询。与提供不断变化的答案的在线聚合不同，近似模式将仅提供两种可能的答案;一个完全执行查询，另一个来自AQP计划。此外，与在线聚合不同，近似模式不需要新的运算符实现（如第2.3节中所述）。 Suchan评估方法也可用于批量查询，其中AAA可以减少资源使用。&lt;/p&gt;

&lt;p&gt;尝试新场景：如所讨论的，对数据的交互式探索可能是AQP最直接的应用。这里，查询可以相对简单（例如，只有select-project-join-groupby操作），并且用户可能不需要精确的答案，但是非常关心极快的响应[21]。另一个例子是生产查询管道;我们在大数据集群中看到许多周期性重复查询，这些查询分析了用于人类消费或可视化仪表板的logsto计算KPI。这些查询的输入是巨大的，例如，点击日志，服务器访问日志。受人类认知和屏幕尺寸限制的输出相当小。因此，此类查询通常具有组和聚合，并且AQP可以降低成本。但是，这些查询也往往是非平凡的（例如，嵌套的SQL语句）。但另一个重要的情况是从后端批处理系统中有效地提取样本的挑战，以便可以重复使用该样本以进行实验。数据分析在他们的桌面上。新方案也带来了不同类型的准确度要求。例如，用户可能只关心结果的排名顺序[61]，或者用户可能只想保留机器学习分类器输出的标签。如何最好地支持AQP的各种准确性要求仍然是一个悬而未决的问题。&lt;/p&gt;

&lt;p&gt;近似查询处理以非常有吸引力的价值主张开始。 今天随着数据泛滥，它更具吸引力。但除非我们重新考虑我们的方法来近似查询处理，着眼于场景和明确的价值主张，我们将只有技术结果，而不是可用的系统。&lt;/p&gt;

&lt;h1 id=&quot;acknowledgements&quot;&gt;Acknowledgements&lt;/h1&gt;

&lt;p&gt;我们非常感谢Christian Konig和Vivek Narasayya阅读本文档的大量版本; 他们的反馈大大改善了这份报告。&lt;/p&gt;
</description>
        <pubDate>Wed, 25 Jul 2018 18:32:20 +0800</pubDate>
        <link>http://localhost:4000/2018/07/Approximate-Query-Processing-No-Silver-Bullet</link>
        <guid isPermaLink="true">http://localhost:4000/2018/07/Approximate-Query-Processing-No-Silver-Bullet</guid>
        
        <category>论文阅读</category>
        
        <category>读书笔记</category>
        
        
      </item>
    
      <item>
        <title>Continuous Sampling for Online Aggregation Over Multiple Queries</title>
        <description>&lt;h1 id=&quot;摘要&quot;&gt;摘要&lt;/h1&gt;
&lt;p&gt;在这篇论文中，我们提出一个在线聚合系统，叫做COSMOS（Continuous Sampling for Multiple queries in an Online aggregation System)，来高效的处理多重聚合查询。在COSMOS中，要先获取一个数据集，从而使对数据集的持续扫描能够对所有的查询的流式随机样本能够提升。此外，COSMOS把查询组织为一个传播图来探索查询之间的依赖关系。用这种方式，更靠近根节点（数据流的来源）的查询集将可能用来计算派生查询的聚合结果。COSMOS使用一些统计学的方法从祖先节点中组合答案来生成一个节点的在线聚合结果。COSMOS同时也提供对未来的可回收的立即查询的分片策略。我们实现了COSMOS系统并在PostgreSQL上开展了扩展性的实验研究。我们在TPC-H标准上的结果表明了COSMOS的效率和有效性。&lt;/p&gt;

&lt;h1 id=&quot;1绪论&quot;&gt;1、绪论&lt;/h1&gt;
&lt;p&gt;聚合查询在许多应用中被广泛使用。比如，在在线分析处理中（OLAP Online Analytical Processing）中，存储在数据仓库中的大量数据经常被用来做聚合总结以支持商业分析和决策制定。不幸的是，聚合查询往往需要很高的代价来处理（即是说处理时间很长）并且以前通常在一个阻塞型模型上进行评估，这导致了非常长的初始化时间。&lt;/p&gt;

&lt;p&gt;为了处理这些challenge，Hellerstein等人提出了一种非阻塞性的在线聚合机制，即近实时地返回一个近似的结果。与给在线聚合方法连续的生成聚合结果以及对应的置信区间，而不是给用户一个聚合的精确结果。中心思想是不断的从一个数据集中抽取样本，用样本计算一个聚合的近似结果，并在更多样本被选取的同时提升聚合结果的质量。为给用户指明近似值得质量，错误边界和中心区间也同时被计算更新。因为样本数量远小于数据集的数量，所以返回近似结果的成本被缩减了。此外，由于聚合查询主要用于得到大数据集的一个粗糙的概览，可以预料的是用户一旦得到他们质量令他们满意的查询结果，他们就会较早的结束查询过程。因此，查询的处理时间会比计算精准聚合结果的时间小得多。&lt;/p&gt;

&lt;p&gt;在这篇论文中，我们研究了如何高效的部署在线聚合来处理多重聚合查询。多重聚合查询有很多种形式。一个简单的复杂查询可能引入多重聚合。举个例子，一个嵌套查询将在内部查询和外部查询中同时引入聚合。另举一例，考虑如下查询（找到特定部门供应商的平均供应数量），这种查询在数据仓库应用中很常见（the lineitem schema is taken from the TPC-H benchmark）：
SELECT AVG(quantity)
FROM (SELECT supp, part, SUM(quantity) as quantity
	 FROM lineitemWHERE part = 10
	 GROUP BY supp, part);&lt;/p&gt;

&lt;p&gt;一个单个用户有很有可能在多重聚合查询中转换。这在OLAP应用中很常见，因为用户可能经常在他或她的数据立方操作中向上或向下操作。最后，不同用户提出的聚合查询可能共享一张数据表。我们注意到在这些查询（和子查询）中存在许多依赖关系，比如，我们能够潜在得获取一个查询（或子查询）的在线聚合结果通过其他的查询（或子查询）的在线聚合结果。此外，我们可以潜在地重复使用可回收的样本来提升一大堆查询（而不是每个查询仅回收它自己的样本）。&lt;/p&gt;

&lt;p&gt;我们提出了一个叫COSMOS的在线聚合系统，来高效的处理多重聚合查询。COSMOS有一大堆鲜明的特性。
	1. 它随机地抓取一个数据集如此回收自任意地方的元组能被所有的查询作为随机样本。
	2. 它连续的扫描抓取的数据集来生成一个样本流。
	3. 为了探究查询之间的依赖关系，COSMOS将这些查询组织为传播图，如此靠近根节点的查询将会把他们的估计值反馈给他们祖先查询或依赖查询。这样一个架构能够最小化计算的间接成本。
	4. COSMOS对未来的立即查询也提供一个分治策略。
	5. 最后，COSMOS使用一些统计学的方法将来自祖先节点的结果组合起来生成一个节点的在线聚合结果。&lt;/p&gt;

&lt;p&gt;其他一些工作也提出了连续扫描一个数据集的思想。比如，DataCycle project，整个数据库在高带宽的通信网络上面循环广播，通过一系列的数据过滤器，表现复杂的并行协作搜索操作。最近，George等人提出了CJOIN pipeline，连续的传送元组从一张实际的表到一个大量查询的过滤器序列。我们COSMOS 有着相似的动机，然而，COSMOS循环一个抓取的数据集来产生一个随机样本流。COSMOS与之前的集中架构不同因为它被设计用来做近似查询处理。传播图中的每个节点都是一个查询（这与CJOIN中的以为过滤器不同）并且节点共享聚合结果（而不仅仅是元组）。&lt;/p&gt;

&lt;p&gt;我们实现了COSMOS冰鞋在PostgreSQL上用TPC-H标准进行了评估。我们的扩展性能研究表明COSMOS能够很快地收敛出一个很好的近似结果。并且，可以看到它比许多原生的算法更加高效。&lt;/p&gt;

&lt;p&gt;这篇论文的剩余部分按下列形式进行组织。在下一部分，我们将给出COSMOS的一个概览。在第三部分，我们将展示我们将查询组织成一个传播图的算法，在第四部分我们展示出我们的在线聚合中使用的统计估计器。第五部分我们说明我们的一个实验研究的成果。第六部分回顾相关工作。最后我们对本篇论文做一个总结。&lt;/p&gt;

&lt;h1 id=&quot;2cosmos概览&quot;&gt;2、COSMOS：概览&lt;/h1&gt;
&lt;p&gt;图1说明了COSMOS的系统架构。COSMOS主要有两个组件构成：爬取器和传播图。
&lt;img src=&quot;/assets/postsimg/cosmos-1.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;爬取器&quot;&gt;爬取器&lt;/h3&gt;

&lt;p&gt;给定一个数据集，爬取器的任务就是从数据集中生成一个随机样本流。传统的实现方式是在运行是从数据集中随机的选取样本。然而，我们却提倡把抽取出的随机样本序列存储为一个爬取的数据集。用这种方式，通过扫描爬取集，我们就能够生成一个随机样本流。这种设计来自于一系列的简单而有趣的观察（这也符合这种方法的优点）。首先，我们从原始数据集的一个随机页中获取一个随机样本，尽管我们有一页从爬取数据集的一页中获取的随机样本。其次，我们能有效的消除随机查找，并且能够从爬取数据集中序列扫描获取样本。这意味着取样的I/O成本被大幅度的减少了。事实上，这种“顺序访问数据的收益是巨大的”因为“完全的随机磁盘访问能顺序访问慢五个数量级”。[9]这篇论文中的结果表明随机访问和顺序访问的吞吐量分别是316 values/sec和 53.2M values/sec （这篇研究在一台Windows 2003服务骑上，这台服务器的配置是64GB RAM，8*15000RPM SAS一RAID5配置的磁盘，每条记录的大小是16个字节）。我们自己的初步研究表明顺序地扫描一个100GB数据集的时间大概是1400sec，对应的是随机从数据集中随机取样时间的1.5%。第三，读取k个页面的样本，我们就能拥有大量的样本（比在传统的算法中k个随机页获取k个样本多）。这也就是说错误边界更低以及置信度更高（我们第五部分的实验研究证明了这一点）。从另一个角度来看，这也意味着我们能够在和传统的算法达到相同准确度的同时更快的访问更少的页面，或者在同时访问k个页面的同时得到更高的准确率。
第四，我们连续的在爬取的数据集中循环–当访问到最后一页时，从第一页重新开始。这意味着当一个查询被提交处理时，我们能够为该从任意一页开始进行取样。我们把每个查询读取的第一页作为它自己的抛锚页（anchor page)。一个查询将达到精准答案，如果必要的话，当相同的抛锚页再一次被读取时并且，一个稍晚到达的查询可能能够重新使用(可能还在执行的)稍早查询的结果（而不仅仅是数据样本本身），因此能够比一个更早的抛锚页更早地到达它自己的抛锚页，从而在更短的时间内更好的提高一个估计聚合的准确率。&lt;/p&gt;

&lt;p&gt;为了爬取这样一个数据集，我们采用了如下的一个简单的策略：我们顺序地扫描一个文件，当我们扫描每个元组时，我们将把它放置在一个初始化为空的爬取集的一个随机的位置上。爬取集接下来用同种方式继续爬取。上述过程重复许多次。最后，爬取集就可以被用于在线聚合的源数据集了。&lt;/p&gt;

&lt;p&gt;对于引入多重关系的查询，对立即结果生成一个随机样本流可能很有必要。基本上，可以使用两种算法。我们可以先预计算join的结果然后再爬取。或者，我们可以在查询的join属性上建立索引从而使用索引嵌套循环join。为了从这两种方式的join中生成一个随机的样本流，我们选取一个关系作外关系R，另一个关系作为内关系S。我们从R中抽取样本就像在单个关系表中那样，顺序扫描爬取集。对每个从R中选取的样本记录，我们检索S的索引。join的输出则构成了两个关系join的随机样本流。第一种架构在存储和效率、准确率之间进行了折中，第二种架构牺牲了效率和准确率来满足灵活性。在数据仓库系统中，大多数查询是主键/外键做join（如TPC-H schema）。我们可以使用第一种架构做抽取。正相反，如果查询是陆陆续续的提交的（if queries are issued on the fly），那么第二种架构比较合适。&lt;/p&gt;

&lt;p&gt;在我们的系统中，我们采用了离线批量更新的策略。数据库系统的更新被收集起来然后进行批量处理。在这个过程中，将不会处理查询。如果有一大批的更新需要处理，那么在所有的更新都提交了以后，我们将会重建这个爬取集。此外，对每个新插入的元组t，我们随机地从爬取集中选择一个元组t’并用t代替t’。t’追加到爬取集的最后。&lt;/p&gt;

&lt;h3 id=&quot;将查询组织成传播图&quot;&gt;将查询组织成传播图&lt;/h3&gt;

&lt;p&gt;第二个组件是传播图，是一个有向无环图，其中节点表示查询，两个节点之间的边表示两个查询之间的依赖关系。这种依赖关系使得一个父节点的结果能够被它的子节点所使用。数据源是图的根节点。正如图1所示，从爬取集中读取的数据页首先缓存在一个样本buffer中。缓冲区中的记录接着向查询传播，然后被丢弃这样缓冲区中的空间能够被释放出来然后可以读后面的数据页。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/postsimg/cosmos-2.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;在一中极端情况下，我们可以拥有一个胖的（双层的）传播树，其中所有的查询都仅依赖于源数据流。这对应的情况是所有的查询都不相互依赖。然而，每一个样本的读取都被所有的查询共享。一个典型的传播图能够有机会共享聚合的立即结果，而不仅仅是数据。例如，考虑下面三个查询（使用TPC-Hschema作为示例）：
&lt;img src=&quot;/assets/postsimg/cosmos-3.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;假设查询按如下顺序到达：Q1，Q2，Q3。现在，尽管Q1和Q2共享数据的子集，但是牺牲Q1的结果给Q2也不可能，因为我们只能维护一个对Q1单个的运行时平均值以及错误边界。幸运的是，我们观察到如下：如果我们把基于Q1的结果按照returnflag做分划（例如我们对于不同的returnflag生成运行时均值和错误边界），那么我们就可以循环使用两个分划的输出给Q2（Q1仅需要检查元组的quantity是否≥20以及returnflag是否＝“r”or“a”)。像这样，我们如何使用Q2的输出给Q3就很清晰。然而，这个问题，对于Q3就更加复杂因为它能够同时使用Q1和Q2的分划。组合Q1和Q2的分划来生成Q3的结果比较困难。因此，我们需要一个更加侵略性的策略来均衡立即结果。
&lt;img src=&quot;/assets/postsimg/cosmos-4.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;图2展示了一个再利用查询之间的分划的示例。假设表被按照quantity和returnflag分划成了9个小格子。Q2可以再利用对Q1的5,6,8,9的结果，Q3能够利用除第一个格子以外的所有格子的结果。有意思的是，查询的到达顺序能够影响再利用。例如，如果Q3先到达，那么它就可以被分划成同时对Q1和Q2有利的结果。&lt;/p&gt;

&lt;p&gt;现在，我们能够识别出我们在传播图设计中的关键challenge。
	1. 我们需要决定样本和回答如何被分划。我们的思想是把样本和回答分划成小格子（正如图2所示的那样），然后回收利用包含在一个查询中的小格子。
	2. 我们需要一种方式来测量查询之间的依赖关系。基于这种关系，我们能够构建有向无环图来再利用样本回答。然后我们需要随着请求的提交和完成动态的维护该有向无环图。
	3. 每个查询的结果都是从可能多个的父节点中提取的（包括数据源）。我们需要使用统计工具来把这些部分回答合并成一个查询答案。
我们将在第三部分讨论前三个issue，在第四部分讨论最后一个issue。&lt;/p&gt;

&lt;h1 id=&quot;3传播图&quot;&gt;3、传播图&lt;/h1&gt;
&lt;p&gt;给定一个查询集，我们将其组织为一个数据流图。图中的每一个节点对应一个查询，节点之间通过数据流连接。样本以及部分结果在节点之间通过数据流共享。当一个查询加入到系统中时，它选取某些节点作为它的数据源并通知这些节点它所请求的样本和回答。相应的节点则会为这个新节点生成一个数据流。样本或部分结果之后就会流向这个心得节点，然后就会组成这个新节点自己最终的结果（同时也可能维护一些结果以便再利用）。在这个部分，我们讨论如何建立和维护这个传播图。&lt;/p&gt;

&lt;h3 id=&quot;基于查询的分划&quot;&gt;基于查询的分划&lt;/h3&gt;
&lt;p&gt;当一个新的查询加入到系统中时，我们需要评估它与现有的查询之间的关系。特别的是，如果两个查询需要处理一个公共子集的元组，我们就可以让这两个查询共享样本以及部分结果，比如第二部分的查询Q1和Q2。然而，正如提到的那样，Q2能使用Q1结果的前提是Q1需要维护它自己回答的分划。此外，尽管Q1分划了使得Q2能够再利用这些回答，也可能再来一个Q4（如 select avg(discount) from lineitem groupby returnflag, quantity;），且并不能够利用Q1为Q2所做的分划。为了处理这个问题，我们采取了，作为第一次切分，一个直接的解决办法，把数据空间静态的分割成微小的格子来保证回答中包含的格子能够回收利用。&lt;/p&gt;

&lt;p&gt;为了将数据空间划分成格子，我们需要识别出分划的候选属性。我们将属性识别成两种类型来作为分划的候选。
类型1是那些出现在“Group By”从句中的属性列。通过对这些属性列的分划，我们可以再利用样本来回答“group by”查询。
第二种类型的数据列是出现在“Where”谓词中的属性列。通过对第二种类型属性的划分，我们能够重利用样本来回答具有不同选择谓词的查询。&lt;/p&gt;

&lt;p&gt;对于1-型属性，我们基于分组的名字来分划列，如果分组的数量比Ng小，其中Ng是一个系统预先决定的参数。此外，我们还根据2-型属性来分划列。第2-型属性，我们基于值来划分。在接下来的讨论中，我们关注如何在2-型属性上自适应的分划。一种直接的方法是统一分划空间（例如，对于表的每一列，我们将之均等的分成k个小格子）。不幸的是，这种方式苦于维度的诅咒，一张表有10个分划属性那么每个属性被分成10个范围将会有1010个小格子。小格子的数量可能比元组的数量还多。维护包含部分结果的所有小格子是不切实际的。
&lt;img src=&quot;/assets/postsimg/cosmos-5.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;一个可选择的方法，我们称之为Partition，是把空间基于查询的工作量进行分划。一个查询训练集可以收集起来作为工作量的代表。这种架构的思想是对每个查询分划空间使得格子被完整的包含在某些查询中，并且我们能够在查询之间共享这些部分结果。图3阐述了我们的算法的思想。我们基于查询Q1和Q2对空间进行了分划。生成了一个一个5*5的分划，每个查询的搜索范围包括4个格子。Q1和Q2共享一个小格子。这种算法运行表现的非常好，如果搜索条件是有限的。然而，大部分晴朗下，这种算法还是会生成太多的小格子。为了苏建维护成本，我们提出了一种基于查询的自适应的分划架构，QueryPartition，来合并一些分划。
&lt;img src=&quot;/assets/postsimg/cosmos-6.png&quot; alt=&quot;效果图&quot; /&gt;
算法1描述了我们自适应架构算法。Sq是训练集以及pNum是系统设置的分划的最大数量。如果分划的数量小于pNum了，那么我们就可以终结该过程。否则，我们将迭代的执行合并分划。在每个迭代过程中，我们组合一系列的分划。特别的是，对每个分划属性，假设它已经被分割成了k个子范围r1,r2，…，rk。我们试图组合这些连续范围。在相应的分划都被合并以后，我们评估现有分划的利用率。在这个过程中，我们使用了一个简单的利用率度量值–我们简单的计算能被再利用的格子的数量。在每个迭代中格子的数量都在减小并且我们能在格子的数量减小到对应阈值时终止这个过程。&lt;/p&gt;

&lt;h1 id=&quot;传播图&quot;&gt;传播图&lt;/h1&gt;

&lt;p&gt;分划空间的目的有两个方面。首先，它使得我们能够轻易的决定一个查询如何分划来对其它查询有益。在图2 中，我们将空间预先分划成了9个小格子（基于两个属性，quantity和returnflag）。当Q1到达是，它组织它的部分回答到6个部分（基于预分划）。第二，它使得我们能够轻易的确定哪些可以被共享。在图2中，当Q2参与进来的时候，它将它的回答组织成6个部分，并且注意到它能够从Q1中再利用4个分划。。&lt;/p&gt;

&lt;p&gt;传播图是一个有向无环图（DAG）。每个节点代表一个查询。我们使用Qi来表示节点i或查询Qi。样本流源，用Q0表示，构成了有向无环图的根节点。一条边Qi→Qj表明从Qi到Qj有数据流。特别的是，对于一条从Q0→Qi的边，实际的样本数据是从样本源流向节点Qi的。Qi将基于收集到的样本进行计算分划的聚合结果。如果一个查询只有一个格子的部分（而不是一个完整的格子）参与，那么summary data也会用于计算他们；然而，这样的部分分划将不能够被回收共享。这些样本随后将会被丢弃。注意到一个查询有可能不满足预分划（e.g., a query that groups by discount）。在这种情况之下，这样的一个查询也将从Q0中抽取样本并用于计算它自己的回答。对这些查询，我们目前的解决方式是不提供任何机会来回收他们的回答。需要更侵入式的分享方法，我们计划在未来的工作中讨论这个。&lt;/p&gt;

&lt;p&gt;另一方面，对于Qi→Qj（i,j≠0）这样形式的一条边，不需要传输样本集；而是，那些共享的小格子的聚合结果将从Qi传至Qj。参考图2，边上的数量表示数据（样本或部分结果）的小格子需要被传送–正常字体表示实际样本，斜体字表示聚合后的数据。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/postsimg/cosmos-7.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;每个查询节点在它的上游注册自己需要的格子。参考图2，在Q1上，我们看到Q2注册了它自己需要的有聚合结果的格子5,6,8,9；Q3注册了它感兴趣的聚合数据格子4和7.我们还可以看到，Q2保留了数据的来源（它从Q1的部分结果中获得了格子5,6,8和9，从根节点上获得了样本数据格子2和3）。传播图中的节点根据下游节点的注册信息来传播样本数据和部分结果。传播图定义了样本如何在查询之间传播。&lt;/p&gt;

&lt;p&gt;我们现在可以开始讨论传播图如何构建了。构建一个传播图的中心思想是促进样本的共享。当我们在小格子之间传播样本的时候，两个查询之间的关系也由其涉及的小格子而确定了。一般来说，如果两个查询涉及到相同的小格子，那么我们就能够再利用该小格子的部分聚合结果。对一个特定查询Qi，小格子可以分成以下三种类型。
&lt;img src=&quot;/assets/postsimg/cosmos-8.png&quot; alt=&quot;效果图&quot; /&gt;
对于1-型小格子，Qi需要从数据源（Q0）中提取样本如果不存在它可以回收利用的查询；否则，如果有部分结果可以使用，它就会重利用它。对于2-型小格子，Qi需要从Q0中提取样本来计算它的部分结果，由于该种类型的的小格子的结果不能被Qi使用（因为这些结果是基于从整个小格子空间获取的）。我们使用f1（Qi）和f2（Qi）来分别表示Qi的1-型和2-型小格子的集合。为了简化描述，我们定义函数F如下：
&lt;img src=&quot;/assets/postsimg/cosmos-9.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;F返回能够在查询之间共享的小格子。很明显，F(Qi,Qj)=F(Qj，Qi)。&lt;/p&gt;

&lt;p&gt;令Sq表示系统现有的查询集。当新查询Qi出现在系统中，我们在Sq中搜索查询并将Qi与这些查询联系起来，从而是这些查询的部分结果能够再利用。直观的说就是最大化结果的共享。算法2表明了我们求相关查询的主要思想。首先，按F函数求集合中查询与Qi的公共格子个数并按照倒序排序。如果查询Q1和Q2拥有相同的F值（即F(Q 1 , Q i ) = F(Q 2 , Q i )），Q1的评分将高于Q2当且仅当|f 1 (Q 1 )| &amp;lt; |f 1 (Q 2 )|. 换句话说，我们更偏爱设计更少1-型小格子的查询。然后，我们连续的从列表中提取前面的的查询新来的查询的搜索范围已经被全部覆盖或是候选队列中已经没有查询。当把一个查询插入结果集，我们将重新计算剩余查询的可重用的格子及分数。我们通过删除已经在结果集中的查询的效果来减少查询的分数。我们使用F来计算两个格子集中的公共格子集。
&lt;img src=&quot;/assets/postsimg/cosmos-10.png&quot; alt=&quot;效果图&quot; /&gt;
&lt;img src=&quot;/assets/postsimg/cosmos-11.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;假设算法2找到了对新进查询Qi的集合Sr。Qi将作为Sr中查询的子节点（后代）加入系统。特别的是，对于Sr中的任意查询Qj，我么都添加一条边Qj →Qi 。算法3描述了一个查询节点的加入过程。G表示在Qi中涉及的格子集。我们迭代Sr中的所有查询并添加对应边。当加入边Qj→Qi时，Qi将在注册它需要从Qj提取的格子。最后，如果有些格子不能在已存在的查询集中找到，Qi直接从根节点（数据源中）拉取样本。&lt;/p&gt;

&lt;p&gt;从根节点到一个查询的数据流由从数据库中提取的样本组成，而从查询到另一个查询的数据流则由包含部分结果的格子组成。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/postsimg/cosmos-12.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;图6描述了将一个新查询加入传播树的过程。在这个例子中，我们假设数据空间已经被分划成了9个小格子（记为1到9）。上图表示了Q1请求从格子1到格子5的样本元组。在Q1上，维护了从格子1到格子5的部分查询结果。Q3请求格子4到8.不过，它能够从Q1中在利用格子4和格子5的聚合结果，但是也需要从数据源获取6-8的样本元组。现在，假设Q6加入到系统中，并且它覆盖了2,3,8，还与格子9有部分重叠。Q6搜索已存在的查询并重利用格子2,3,8的结果。查询Q1，Q2和Q4能够共享他们对格子2的结果。Q2被选取因为它只维护了3个格子的结果因此成本最低。相似的，Q2和Q5倍选取用来提供3和8的结果。由于Q6只是部分覆盖格子9的结果，它将直接从样本源中获取样本。为了提高性能，它继承了来自样本源的对该格子（9）缓冲的样本.
&lt;img src=&quot;/assets/postsimg/cosmos-13.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;当一个查询终止时，我们需要把它从系统图中移除并重新组织查询节点。假设查询Qi结束了。我们需要移除它在上游节点中注册的信息并重新组织下游节点的查询，因为这些节点对Qi有依赖。算法4描述了查询节点离开系统的处理。对于Qi下游节点中的每个查询Qj，我们为Qj对Qi的上游节点进行排序。然后基于该结果，我们添加查询中的新边。图5描述了查询间的数据流重新组织的一个例子。这里，Q3（图4中）完成了它的处理并离开系统。它的下游节点Q4和Q5需要调整它们的连接。基于算法4，新的数据流图如图5所示，其中Q4和Q5被连接到了根节点和Q1。
&lt;img src=&quot;/assets/postsimg/cosmos-14.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;在传播图上的在线聚合&quot;&gt;在传播图上的在线聚合&lt;/h1&gt;

&lt;p&gt;在这一部分，我们描述COSMOS如何操作。在传播图上，根节点连续的扫描爬取集并缓存样本到缓冲区。图中的每个节点将会获得两种类型的数据流（其中之一可能为空）。从根节点指向查询节点的数据流提供格子空间的实际样本。两个查询节点之间的数据流传输的是聚合结果以及1型格子（完全被包含在查询中的格子）。为了减少更新成本，根节点只当缓冲区满时才向其它节点批量传送样本。当每个节点批量获得样本，它重计算它自己的聚合结果以及误差范围并更新给下游节点。新到的数据流将会对每个查询节点触发一个更新时间，并使用算法5来更新自己的结果及错误边界。
&lt;img src=&quot;/assets/postsimg/cosmos-15.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;在算法5中，查询节点首先用新到的数据流更新它自己涉及到的格子。如果一个数据流是1型格子的部分结果，那么该节点只需要保留该结果的副本即可。如果数据流是从数据库来的新样本，我们需要重新计算各个格子的聚合结果（1型的和2型的）。我们将在第四部分讨论聚合计算的公式。需要注意的是，在这一步的最后，我们就有了每个格子的聚合结果以及误差范围。注意，一个查询的真正聚合结果需要合并这些部分结果。同上，我们将在第四部分套路这些结果如何合并。&lt;/p&gt;

&lt;p&gt;在查询更新它自己的结果之后，它开始向下游节点传播自己的结果。对于一个下游节点Qi以及它注册的格子集G，对任意gi属于G，如果gi的结果已经更新，我们将gi的新结果递给节点Qi。&lt;/p&gt;

&lt;p&gt;查询可以在以下两种情况下终止。1、查询已经扫描完了整个数据集并生成了最终准确的结果。最开始，当一个查询获得了一个格子的样本，它将标记该格子以这样本为起始页（抛锚页）。如果该格子再次看见起始页，它将停止获取样本因为它已经扫描了整个的数据集。如果查询涉及的搜索格子都停止获取样本了，那么该查询就能生成准确的结果了。此外，如果一个查询从它的上游节点获取格子的信息，它将继承该上游节点的起始页（抛锚页）信息。2、第二种情况由用户决定。当用户对结果满意时，他能够在扫描完整个数据集之前终止查询处理。&lt;/p&gt;

&lt;p&gt;在上述讨论中，我们展示了传播图的维护策略，这个策略用于回收利用完全包含在查询中的格子的样本。如果格子只是部分的与一个查询相重合，我们必须从数据源中获取样本，令与当前查询有覆盖的格子的集合记为Sg。为了促进在Sg中的查询处理，我们为Sg中的格子维护了一个样本缓冲区。特别的是，样本源为每个在Sg中的样本保留最近k个样本。当gi收到一个新样本时，它会被插入到缓冲区中，如果缓冲区满，老的样本将会被丢弃。&lt;/p&gt;

&lt;p&gt;给定一个新的查询Q，假设gi与Q部分重叠。当S加入到传播图时，我们检查gi在源节点的样本缓冲区。对于超出Q谓词条件的样本，我们使用其来计算gi的初始结果（为了有效的定位满足谓词的样本，我们可以使用索引结构，比如R-tree，来维护缓冲区中样本）。初始化后，gi的结果将会被来自于数据源的节点所更新。&lt;/p&gt;

&lt;h1 id=&quot;4统计估计&quot;&gt;4、统计估计&lt;/h1&gt;
&lt;p&gt;在COSMOS中，对于传播图中的每个节点/查询，有如下三种值需要估计：
1、对直接连向数据源的查询所需要的1型格子的估计
2、对2型格子的估计–这对于部分覆盖它的查询的格子的查询有需要，样本需要从数据源获取（this is needed for a query that requiresgrids that partially overlap its query region and samples haveto be drawn from the sample source）
3、对查询本身的估计–需要整合上述两种估计&lt;/p&gt;

&lt;h3 id=&quot;对格子的估计&quot;&gt;对格子的估计&lt;/h3&gt;

&lt;h3 id=&quot;整合估计&quot;&gt;整合估计&lt;/h3&gt;

&lt;h1 id=&quot;5实验研究&quot;&gt;5、实验研究&lt;/h1&gt;
</description>
        <pubDate>Tue, 17 Jul 2018 18:32:20 +0800</pubDate>
        <link>http://localhost:4000/2018/07/Continuous-Sampling-for-Online-Aggregation-Over-Multiple-Queries</link>
        <guid isPermaLink="true">http://localhost:4000/2018/07/Continuous-Sampling-for-Online-Aggregation-Over-Multiple-Queries</guid>
        
        <category>论文阅读</category>
        
        <category>读书笔记</category>
        
        
      </item>
    
      <item>
        <title>AQP++ Connecting Approximate Query Processing With Aggregate Precomputation for Interactive Analytics</title>
        <description>&lt;h1 id=&quot;摘要&quot;&gt;摘要&lt;/h1&gt;

&lt;p&gt;交互型数据分析要求数据库能够在响应时间内响应用户的查询请求。随着数据量的增长，这逐渐成为一个巨大的挑战。&lt;/p&gt;

&lt;p&gt;过去主要有两种互相独立的思想来解决这个问题，一种是基于采样的近似查询处理（AQP)，另一种是聚合预计算（如data cubes）。&lt;/p&gt;

&lt;p&gt;在本篇论文中，我们主张结合两种思想来解决交互型数据分析的问题。我们提出了AQP++，一个使得这种连接成为可能的框架。该框架能够在取样和预计算中取得一个较好的平衡。我们将讨论该种方式的优点和挑战。我们对这些问题以范围查询为例进行了深入的研究，并探索最优的解决办法。我们的实验使用了两套公共的基准以及真实的数据集来证明我们的AQP++非常的灵活以及在预处理、响应时间、以及结果质量上比AQP和AggPre更好。&lt;/p&gt;

&lt;h3 id=&quot;让二者相结合的思想来源&quot;&gt;让二者相结合的思想来源&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;预处理的数据已经在那里，不用白不用&lt;/li&gt;
  &lt;li&gt;AQP和AggPre有各自的折中，让两者结合可以提供更灵活的平衡，在预处理开销、查询响应时间以及查询结果的质量上，更好的满足用户的需求。&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;aqp的中心思想是&quot;&gt;AQP++的中心思想是：&lt;/h3&gt;
&lt;p&gt;用取样来估计与已经预计算的聚合结果之间的不同部分。
比如我们想估计如下查询的结果：
&lt;img src=&quot;/assets/postsimg/aqp-1.png&quot; alt=&quot;效果图&quot; /&gt;
假设下面查询结果已经进行过计算了：
&lt;img src=&quot;/assets/postsimg/aqp-2.png&quot; alt=&quot;效果图&quot; /&gt;
为了估计q(D)，AQP++使用样本来估计去（D)与pre（D）之间不同的部分:
&lt;img src=&quot;/assets/postsimg/aqp-3.png&quot; alt=&quot;效果图&quot; /&gt;
然后将估计值与预计算的值相加，即可得到我们想要的查询结果q(D).&lt;/p&gt;

&lt;h3 id=&quot;aqp具有普适性&quot;&gt;AQP++具有普适性：&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;它支持很多聚合函数（SUM、COUNT、AVG、VAR）&lt;/li&gt;
  &lt;li&gt;可以很容易地扩展来支持许多优化技术，比如分层抽样和外部索引等&lt;/li&gt;
  &lt;li&gt;对于任意聚合查询，AQP能够对其进行无偏估计的话，AQP++也可以。即是说，估计值的期望等于真实值。&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;为了量化估计结果的不确定性，我们研究了AQP++如何计算置信区间，以及示范了什么时候AQP++能返回一个更小的置信区间。我们将用户查询的和预处理的查询当成两个变量。研究表明，两个变量之间的相关性越强，结果越准确。极端的来说，如果两个查询一样，以为着相关系数为1，AQP++将返回查询的真实解雇。&lt;/p&gt;

&lt;p&gt;为了测试AQP++在预处理成本、响应时间、响应质量与AQP、AggPre相比的效果，我们AQP++在范围查询上进行了深入的研究。&lt;/p&gt;

&lt;p&gt;研究主要需要解决两个问题：&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Aggregate Identification。 找出和用户查询最接近的预处理的聚合查询。&lt;/li&gt;
  &lt;li&gt;Aggregate Precomputation。哪些聚合查询需要进行预计算，在空间成本有限的前提之下。&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;我们将使用一个简单额例子来阐述这两个challenge。
假设用户想要查询：
&lt;img src=&quot;/assets/postsimg/aqp-4.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;其中x，y=1,2,…,100.一个有效的AggPre方法是计算出一个prefix cube(前缀立方)。在这个例子中，一维的前缀立方包括100个格子：
&lt;img src=&quot;/assets/postsimg/aqp-5.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;其中t=1,2,…,100.一旦前缀立方建立了，那么任何用户查询都将通过不超过两个格子来计算得到。由于有101*100/2=5050中用户查询，也就说100个格子能包含5050种查询的结果。&lt;/p&gt;

&lt;p&gt;让我们首先考虑aggregate-identification问题。假设说，由于空间限制，我们只能存10个格子。在中情景之下，数据立方就只能包含55种聚合的结果。给定一个查询，如：
&lt;img src=&quot;/assets/postsimg/aqp-6.png&quot; alt=&quot;效果图&quot; /&gt;
AQP++ 需要知道如下55个已处理的聚合中哪个用来估计用户的查询。
&lt;img src=&quot;/assets/postsimg/aqp-7.png&quot; alt=&quot;效果图&quot; /&gt;
由于查询结果的质量高度依赖于所选择的最近查询，这个决定必须做的很仔细。我们不可能遍历所有的已处理的聚合值。我们提出了一种非常有效的解决该问题的算法。核心思想是快速识别出长得最像的查询并一一检验是否为最合适的。我们证明了该算法的在特定约束下的优越性以及在通常配置下有较好的实验性能。&lt;/p&gt;

&lt;p&gt;接下来讨论aggregate-precomputation问题。&lt;/p&gt;

&lt;p&gt;空间预算一定的情况下，怎么选出应该被预处理的查询。为了解决这个问题，我们发现对分划的选择有两个因素非常的重要，属性相关性和数据的分布。我们首先证明了，如果属性A和C相互独立，且C没有重复值，那么等分划是最优的。这个理论指导我们提出了一个启发式爬坡算法来自动的调整分划的架构基于实际的属性相关性以及数据分布性。&lt;/p&gt;

&lt;p&gt;上述示例仅阐述了一维的范围查询的challenge，在多维情况下，将会有更多的Challenge。&lt;/p&gt;

&lt;h3 id=&quot;总结&quot;&gt;总结：&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;主张结合AQP和AggPre&lt;/li&gt;
  &lt;li&gt;深入研究范围查询，并对其中两个主要问题进行建模：
aggregate identification and aggregation precomputation.&lt;/li&gt;
  &lt;li&gt;提出了解决的算法。&lt;/li&gt;
  &lt;li&gt;识别出aggregation-precomputation problem两个关键影响因素。&lt;/li&gt;
  &lt;li&gt;我们队AQP++ 用商业化的OLAP系统在三个数据集上进行了评估，实验表明我们在得到精确10倍的结果的同时仅耗费了一个很小的预处理开销。&lt;/li&gt;
&lt;/ol&gt;

&lt;h1 id=&quot;相关工作&quot;&gt;相关工作&lt;/h1&gt;

&lt;h3 id=&quot;近似查询处理&quot;&gt;近似查询处理：&lt;/h3&gt;
&lt;p&gt;基于采样的近似查询处理，关注于分层抽样，还有一些提出基于外部索引的采样。AQP++可以使任意AQP引擎与AggPre相结合。因此所有的这些AQP技术都能拓展到AQP++。&lt;/p&gt;

&lt;p&gt;（将AQP++与现有的一些技术进行对比）&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;AQP++使用基于全量数据的预计算结果而不是仅一些样本上近似结果&lt;/li&gt;
  &lt;li&gt;AQP++使用样本来估计所求回答与预处理的回答间的不同部分而不是使用模型来预测那些为估计的点。&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;聚合预计算&quot;&gt;聚合预计算：&lt;/h3&gt;
&lt;p&gt;数据立方，存下空间中各种可能的聚合结果，被广泛使用在数据仓库之中。&lt;/p&gt;

&lt;h1 id=&quot;问题建模&quot;&gt;问题建模&lt;/h1&gt;
&lt;p&gt;这一部分介绍问题建模，为了便于表达我们假设查询没有group by从句。Group by部分的扩展间附录c部分。&lt;/p&gt;

&lt;h3 id=&quot;定义1-查询模板&quot;&gt;定义1 （查询模板）&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;/assets/postsimg/aqp-8.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;例如：[SUM(sale),age]     查询产品价格与顾客年龄之间的关系&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;为了便于表示，在后文中我们假设f=SUM并在附录中讨论其它聚合函数之间的拓展。并且，我们假设每个Ci的域为dom(Ci) = {1,2,…,/&lt;/td&gt;
      &lt;td&gt;dom(Ci)/&lt;/td&gt;
      &lt;td&gt;},并把一个范围查询缩写为SUM（x1:y1,x2:y2,…,xd:yd）&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;在AggPre计算中，人们经常计算前缀立方（或其变体）来回答范围查询。&lt;/p&gt;

&lt;h3 id=&quot;定义2前缀立方&quot;&gt;定义2（前缀立方）&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;/assets/postsimg/aqp-9.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;每一个回答被称为立方中的格子。关于P-Cube的一个非常好的性质是，任何一个范围查询Q，它的回答都能用不超过2d个小格子来计算。比如，一个一维查询，SUM（3:5）。该查询的结果可以通过两个小格子获取，比如，SUM（1:5）-SUM（1:2）。对于一个2D的查询，问题的结果能通过最多不超过四个格子得到。如下图所示：
&lt;img src=&quot;/assets/postsimg/aqp-10.png&quot; alt=&quot;效果图&quot; /&gt;
然而，计算整个P-Cube的代价一般比较昂贵，一共需要计算
&lt;img src=&quot;/assets/postsimg/aqp-11.png&quot; alt=&quot;效果图&quot; /&gt;
个小格子。因此我们计算一个区块前缀立方，只用包含一小部分格子。&lt;/p&gt;

&lt;p&gt;定义3（区块前缀立方）
&lt;img src=&quot;/assets/postsimg/aqp-12.png&quot; alt=&quot;效果图&quot; /&gt;
BP-Cube减少了需要预计算的的小格子数。比如考虑一个二维查询Q：[SUM（1），C1，C2]，其中dom(C1)={1,2,…,15},dom(C2)={1,2,…,8}.完整的P-Cube包含15&lt;em&gt;8=120个小格子， SUM( 1 : y1 , 1 : y2 ) for all y1 ∈ [1 , 15] and y2 ∈ [1 , 8]。 dom(C1 ) small = { 5 , 10 , 15 } and dom(C2 ) small = { 4 , 8 } .那么BP-Cube仅包含3&lt;/em&gt;2=6个cell。&lt;/p&gt;

&lt;h3 id=&quot;aggregate-identification&quot;&gt;Aggregate Identification&lt;/h3&gt;
&lt;p&gt;接下来开始定义Aggregate Identification问题。令P表示一个BP-Cube，如：
&lt;img src=&quot;/assets/postsimg/aqp-13.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;，注意虽然只有P是已知的，由BP-Cube的性质，我们可以假设P+中的所有查询的结果都是已知的。
&lt;img src=&quot;/assets/postsimg/aqp-14.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;如，令dom(C1 ) small = { 4 , 6 } ,P ={SUM( 1 : 4 ), SUM( 1 : 6 )} , 则 P+ = {SUM( 1 : 4 ), SUM( 1 : 6 ), SUM( 5 :6 ),ϕ} , 其中 SUM( 5 : 6 ) 可以由 SUM( 1 : 6 )−SUM( 1 : 4 )得到，ϕ是一个条件永远为假的空查询.&lt;/p&gt;

&lt;p&gt;给定一个用户查询q以及一个样本S，对每个pre ∈P+,AQP++能够返回一个基于某个置信区间的近似值。比如，对q:SUM(1:4).假设AQP++选择了已知的pre：SUM（2:4）并返回了1000+-5（置信概率95%）。这个结果表明查询q的真实结果应该有95%的概率在范围[995,1005]之间。置信区间越大，回答越不精确。因此我们用置信区间的一半定义q对于pre的误差为error（q，pre）。在上述例子中，因为置信区间的宽度是10，那么，error（q,pre)=5.&lt;/p&gt;

&lt;p&gt;一旦一个BP-Cube P已知，由于P+中的任意一个值都可以选择用来估计用户查询，我们需要选择出具有最小的查询误差的那个查询。我们将对P的最小查询误差用error（q,P)=minpre∈p+error(q,pre)来表示。&lt;/p&gt;

&lt;h3 id=&quot;问题1aggregate-identification&quot;&gt;问题1（Aggregate Identification）&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;/assets/postsimg/aqp-15.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;考虑一个一维的例子。给定一个用户查询q:SUM(2:5) 以及一个BP-Cube P = {SUM（1:4），SUM（1:6}，则有四个已知值在P+中，P+={SUM（1,4），SUM（1:6），SUM( 5 : 6 ),ϕ}。聚合识别问题的关键在于识别出这四个值中最好的用来估计q的答案的值。&lt;/p&gt;

&lt;h3 id=&quot;aggregate-precomputation&quot;&gt;Aggregate Precomputation&lt;/h3&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;接下来我们将对Aggregate Precomputation问题进行定义。给定空间预算，我们希望找到满足空间预算的最好额BP-Cube。令/&lt;/td&gt;
      &lt;td&gt;P/&lt;/td&gt;
      &lt;td&gt;表示一个BP-Cube中cell的数量，令k表示&lt;/td&gt;
      &lt;td&gt;P&lt;/td&gt;
      &lt;td&gt;的边界阈值。给定阈值k，有许多不同的方式在&lt;/td&gt;
      &lt;td&gt;P&lt;/td&gt;
      &lt;td&gt;&amp;lt;k的前提下来构建一个BP-Cube。例如假设k=6，d=2.那么BP-Cube的组成方式可以是1 × 6, 2 × 3, 3 × 2 or 6 × 1。对于每一种可能的组成方式，比如2 × 3,一个BP-Cube可以通过从dom（C1)中选择2个值，从dom(C2)中选择3个值来实现。&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;为了决定哪种是最好的，我们定义了一个查询模板误差来量化每个BP-Cube的收益并返回查询模板误差最小的那个BP-Cube。给定一个查询模板Q和一个BP-Cube P，因为一个用户可能提出Q中的任意一个查询，我们定义对于P的查询模板误差为
error (Q, P) = max q∈Q error (q, P),表示对所有可能的用户查询中最大的查询误差。我们选取这个误差度量值的原因是因为它对于减少高度不准确的查询的误差更有效，而不是对已知的非常精确的查询结果的那些查询。当然，还有许多其他的方式来定义查询模板误差。在试验中，我们演示了我们的聚合预处理算法，该算法被用于最优化最大误差，该算法也能够有效的减少其他类型的误差，比如平均误差以及中间误差（average error and median error）。&lt;/p&gt;

&lt;h3 id=&quot;问题2-聚合预计算aggregate-precomputation&quot;&gt;问题2 聚合预计算（Aggregate Precomputation）&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;/assets/postsimg/aqp-16.png&quot; alt=&quot;效果图&quot; /&gt;
考虑一个一维的例子。给定一个阈值k=2一个查询模板Q: [ SUM(A),C1],其中dom(C 1 ) = { 1 , 2 , · · · , 5 } ，聚合预计算问题在于决定最好的BP-Cube P= {SUM( 1 : t 1 ), SUM( 1 : t 2 )} ，其中t1和t2从dom（C1）中选择从而使得error（Q,P)最小。对于多维的情况，问题将会变得更加具有挑战性，，因为我们需要决定BP-Cube的最佳形状，比如2 × 3 还是 3 × 2.&lt;/p&gt;

&lt;h1 id=&quot;从aqp到aqp&quot;&gt;从AQP到AQP++&lt;/h1&gt;

&lt;p&gt;基于取样的AQP    &lt;br /&gt;
AQP的数学基础是取样和估计理论。&lt;/p&gt;

&lt;p&gt;结果估计
&lt;img src=&quot;/assets/postsimg/aqp-17.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;f不能是最大值最小值
典型的聚合函数包括 AVG, SUM, COUNT,and VAR。有些自定义的聚合函数也可以较好的支持。&lt;/p&gt;

&lt;p&gt;置信区间
在估计结果的同时，AQP经常返回一个置信区间来量化估计结果的不确定性。
计算置信区间的两种方式：&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;分析型，基于中心极限定理.缺少一般性，每个查询有它自己的置信区间。（具体计算看论文）
&lt;img src=&quot;/assets/postsimg/aqp-18.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;计算一个经验性的置信区间。一般会在原来的样本之上获取一系列的二次样本，然后在二次采样上估计查询结果。获得的结果构成了一个分布，从这个分布中可以计算出置信区间。这是一个更加一般性的方法。计算成本高。&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;AQP++框架
定制化的结合AQP与AggPre.&lt;/p&gt;

&lt;p&gt;AQP++如何估计结果
&lt;img src=&quot;/assets/postsimg/aqp-19.png&quot; alt=&quot;效果图&quot; /&gt;
先估计ˆ q(S) 再估计ˆ pre(S) ，最后相加。
&lt;img src=&quot;/assets/postsimg/aqp-20.png&quot; alt=&quot;效果图&quot; /&gt;
&lt;img src=&quot;/assets/postsimg/aqp-21.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;然后带入（4）得到结果&lt;/p&gt;

&lt;p&gt;一致性：AQP++用式子（4）把AQP有AggPre结合起来。有趣的是，这个公式表明AQP和AggPre是AQP++的两种特例。&lt;/p&gt;

&lt;p&gt;普适性：支持 SUM,COUNT, AVG, and VAR&lt;/p&gt;

&lt;p&gt;定理1 对任意聚合函数f，如果AQP能得到下列形式的查询的结果：
SELECT f(A) FROM D WHERE Condition ，那么AQP++也可以得到。
证明：见附录A。&lt;/p&gt;

&lt;p&gt;定理2 对于任意的聚合函数，如果AQP的估计是无偏的，那么AQP++的估计也是无偏的。&lt;/p&gt;

&lt;p&gt;AQP++如何计算置信区间
&lt;img src=&quot;/assets/postsimg/aqp-22.png&quot; alt=&quot;效果图&quot; /&gt;
经验型类似上面已经介绍的。不过求的是
&lt;img src=&quot;/assets/postsimg/aqp-23.png&quot; alt=&quot;效果图&quot; /&gt;
的分布。
关于为什么效果更好，误差更小，置信区间更小
&lt;img src=&quot;/assets/postsimg/aqp-24.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;aggregate-identification-1&quot;&gt;AGGREGATE IDENTIFICATION&lt;/h1&gt;

&lt;p&gt;我们先给出对一个简化版问题的解法，然后扩展该加法使它更具有一般性。&lt;/p&gt;

&lt;p&gt;最优解决办法
&lt;img src=&quot;/assets/postsimg/aqp-25.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;暴力破解法：遍历计算 ，成本高&lt;/p&gt;

&lt;p&gt;我们的算法，相关系数越高，越好.
SUM( 4 : 10 ) .  SUM( 4 : 9 ) and SUM( 1 : 3 )
前一个很相关，后一个明显无关。
&lt;img src=&quot;/assets/postsimg/aqp-26.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/postsimg/aqp-27.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;定理3
&lt;img src=&quot;/assets/postsimg/aqp-28.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Aggregate-Identification Approach&lt;/p&gt;

&lt;p&gt;定理3只在特定情况下成立。
The key idea of our approach is to quickly identify a small number of candidate aggregate values from P + and then examine which one is the best among them.将候选集表示为p-.
公式6展示了一维p-的计算方法。
&lt;img src=&quot;/assets/postsimg/aqp-29.png&quot; alt=&quot;效果图&quot; /&gt;
&lt;img src=&quot;/assets/postsimg/aqp-30.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;然后遍历P-
&lt;img src=&quot;/assets/postsimg/aqp-31.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;aggregate-precomputation-1&quot;&gt;AGGREGATE PRECOMPUTATION&lt;/h1&gt;

&lt;p&gt;两个主要挑战：&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;BP-Cube的形状&lt;/li&gt;
  &lt;li&gt;如何选点&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;一维查询模板
等分划&lt;/p&gt;

&lt;p&gt;多维
&lt;img src=&quot;/assets/postsimg/aqp-32.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;
</description>
        <pubDate>Sat, 07 Jul 2018 18:32:20 +0800</pubDate>
        <link>http://localhost:4000/2018/07/AQP++-Connecting-Approximate-Query-Processing-With-Aggregate-Precomputation-for-Interactive-Analytics</link>
        <guid isPermaLink="true">http://localhost:4000/2018/07/AQP++-Connecting-Approximate-Query-Processing-With-Aggregate-Precomputation-for-Interactive-Analytics</guid>
        
        <category>论文阅读</category>
        
        <category>读书笔记</category>
        
        
      </item>
    
      <item>
        <title>Online Aggregation and Continuous Query support in MapReduce</title>
        <description>&lt;h3 id=&quot;一些问题&quot;&gt;一些问题&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;Online Aggregation 是什么？&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;在线聚合是一种用于改进处理昂贵分析查询的数据库系统的交互行为的技术。几乎所有数据库操作都以批处理模式执行，即用户发出查询并等待数据库处理完整个查询。相反，使用在线聚合，用户在查询发布后立即以在线方式获取聚合查询的估计值。例如，如果最终答案为1000，则在k秒后，用户以95％的概率以[990，1020]的置信区间形式获得估计值。随着系统获得越来越多的样本，这种信心不断缩小。
在线聚合由Hellerstein，Haas和Wang [1]于1997年提出，用于在单个表上进行群组聚合查询。后来，作者展示了如何以在线方式评估联接。[2] 2007年，杰梅因等人。设计并实现了一个名为Database-Online（或DBO）的原型数据库系统，该系统通过在线计算多个表的分组聚合查询，更重要的是以可扩展的方式。[3]所有用于在线聚合的方法都使用随机抽样，由于更新奖励理论的检验悖论，这在分布式环境中是不平凡的。 2011年，Pansare等人。提出了一个贝叶斯模型来处理检查悖论，并实现了类似MapReduce的环境的在线聚合[4]。&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Continuous Query 指什么？&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;MapReduce 是什么？
MapReduce详解&lt;/li&gt;
  &lt;li&gt;大数据中的流水线（pipeline）指的是什么？和我们理解的是一个吗？&lt;/li&gt;
  &lt;li&gt;fault tolerance指什么？容错率吗？&lt;/li&gt;
  &lt;li&gt;Map task 、Reduce task?&lt;/li&gt;
  &lt;li&gt;Hadoop。&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;一个支持在线聚合和连续查询的mapreduce框架&quot;&gt;一个支持在线聚合和连续查询的MapReduce框架&lt;/h2&gt;

&lt;p&gt;MapReduce  使开发者以数据为中心，关注数据集的转换，屏蔽了分布式系统的一些细节（分布执行，网络通信，协作，故障恢复）&lt;/p&gt;

&lt;p&gt;作者设计了一个修改过的MapReduce框架，使得数据可以在operators间流水线操作。而传统的MapReduce框架，为了简化故障恢复的设计，每个MapReduce和job的输出是写入磁盘的。&lt;/p&gt;

&lt;h3 id=&quot;流水线pipelinemapreduce有如下优点&quot;&gt;流水线（pipeline）MapReduce有如下优点&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;扩展了MapReduce在批处理间的编程模型&lt;/li&gt;
  &lt;li&gt;减少完成时间&lt;/li&gt;
  &lt;li&gt;提高系统对于批处理作业的利用率
在线聚合：可以让用户得到较早的返回值，即边计算边返回。
连续查询：事件监测和流处理&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;作者搭建了一个称谓HOP的新的MapReduce框架，HOP保留了Hadoop的故障恢复特性，也能够执行用户自定义的原生MapReduce程序。&lt;/p&gt;

&lt;p&gt;MapReduce：一般用于面向批处理的大型计算问题，首先考虑的是作业的完成时间。Google的MapReduce框架和开源的Hadoop系统都保留了这个主要功能，他们的批处理实现策略是：每个Map和Reduce的输出在被下一阶段消费或者输出前都被持久化在磁盘上。&lt;/p&gt;

&lt;p&gt;批量持久化使得故障恢复非常的优雅简洁。我们知道故障恢复在大型分布式系统中非常的重要，因为节点哟很大概率出现挂机或故障。&lt;/p&gt;

&lt;h3 id=&quot;hop-流水线版本的hadoop&quot;&gt;HOP 流水线版本的Hadoop&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;下游的数据流可以在生产者完成操作前消费数据&lt;/li&gt;
  &lt;li&gt;通过流水线可以实现在线聚合&lt;/li&gt;
  &lt;li&gt;支持连续查询&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;流水线机制中存在的challenge&quot;&gt;流水线机制中存在的challenge&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;简单的故障恢复机制。Google基于立即持久化数据实现了。我们可以让流水线机制与立即持久化相结合，通过允许生产者向消费者运送数据与持久化操作并行执行。&lt;/li&gt;
  &lt;li&gt;流水线机制中暗含的频繁通信。这与面向批量操作的“combiners”不同：在通信前执行压缩操作和提前聚合&lt;/li&gt;
  &lt;li&gt;时间同步机制&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;hadoop框架&quot;&gt;Hadoop框架&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;Hadoop MapReduce&lt;/li&gt;
  &lt;li&gt;HDFS（Hadoop Distributed File System）&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;hadoop-mapreduce&quot;&gt;Hadoop MapReduce&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;The Master（The JobTracker）接收作业，分发任务&lt;/li&gt;
  &lt;li&gt;workers（TaskTracker） 处理分发来的任务&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;流水线型mapreduce&quot;&gt;流水线型MapReduce&lt;/h2&gt;

&lt;h3 id=&quot;单个作业间的流水线机制&quot;&gt;单个作业间的流水线机制&lt;/h3&gt;

&lt;p&gt;传统 ： Map-&amp;gt;disk-&amp;gt;Reduce
修改后的：Map-&amp;gt;Reduce&lt;/p&gt;

&lt;p&gt;挑战：
	a. 确定粒度（流水线push）。一个简单做法是生成一条record传一条record。通过预处理的聚合来减少网络拥堵。
	b. 排序问题。本来在阻塞型中，在map里面排好。流水线不能这样，解决办法：缓冲，使到达一个阈值，然后进行排序&lt;/p&gt;

&lt;p&gt;流量控制机制：map生成一个新的分片时，先查询TaskTracker未发送分片的数量，如果这个值超过了一个指定的阈值（比如假设为2），那么mapper将会缓存多个分片，一旦查询到未发送分片的数量低于这个阈值是，将会把这些分片组合、排序好到一个文件中，然后发送。&lt;/p&gt;

&lt;p&gt;combiner流量控制机制：每当调用combiner时，记录下map task输入数据和输出数据的比例，如果combiner能够减小数据量，那么map task 将积累更多的分片。&lt;/p&gt;

&lt;p&gt;作业间的流水线机制
	 支持查询结果的提前返回&lt;/p&gt;

&lt;p&gt;故障恢复
	Map task failure：先合并，不组合，直到确认提交再组合
	Reduce task failure：在作业完成前，map的输出会同时写入磁盘，以便故障恢复&lt;/p&gt;
</description>
        <pubDate>Sat, 30 Jun 2018 18:32:20 +0800</pubDate>
        <link>http://localhost:4000/2018/06/Online-Aggregation-and-Continuous-Query-support-in-MapReduce</link>
        <guid isPermaLink="true">http://localhost:4000/2018/06/Online-Aggregation-and-Continuous-Query-support-in-MapReduce</guid>
        
        <category>论文阅读</category>
        
        <category>读书笔记</category>
        
        
      </item>
    
      <item>
        <title>作为程序员，2017年你习得了哪些新技能</title>
        <description>&lt;p&gt;1.初步掌握了maven的使用&lt;br /&gt;
2.初步学习elasticsearch&lt;br /&gt;
3.掌握了一部分基本的常见的linux系统命令&lt;br /&gt;
4.了解了nginx的基本配置及负载均衡&lt;br /&gt;
5.对spring框架更熟悉了一点&lt;br /&gt;
6.对java的httpclient的使用，有了一定的实践&lt;br /&gt;
7.初步接触了java的多线程编程&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;学无止境吧，以上各个点，都仅仅入门而已。
但是小菜鸡感觉还是学了挺多的知识。&lt;/p&gt;

</description>
        <pubDate>Mon, 18 Dec 2017 18:32:20 +0800</pubDate>
        <link>http://localhost:4000/2017/12/chengxuyuan</link>
        <guid isPermaLink="true">http://localhost:4000/2017/12/chengxuyuan</guid>
        
        <category>年终总结</category>
        
        <category>学习生活</category>
        
        
      </item>
    
      <item>
        <title>软件测试作业之下一天</title>
        <description>&lt;p&gt;同样，还是一个作业。
&lt;br /&gt;
软件测试与质量保证的作业。
&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/next-date.png&quot; alt=&quot;效果图&quot; /&gt;&lt;/p&gt;

&lt;p&gt;程序入口：&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;kn&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;guoyang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Main&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

	&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;MainFrame&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MainFrame&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NextDate&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setVisible&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;kn&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;guoyang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.awt.BorderLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.awt.Color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.awt.Dimension&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.awt.FlowLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.awt.Font&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.awt.GridLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.awt.event.ActionEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.awt.event.ActionListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.awt.event.MouseAdapter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.awt.event.MouseEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.swing.BorderFactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.swing.Box&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.swing.BoxLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.swing.JButton&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.swing.JComboBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.swing.JFrame&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.swing.JLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.swing.JPanel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.swing.SwingConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;javax.swing.border.EmptyBorder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/**
 *  @author guoyang
 *
 */&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MainFrame&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JFrame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JPanel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sunPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 阳历面板&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JPanel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;moonPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 阴历面板&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 日期小格子&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;months&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 阳历每月天数&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 阳历几号&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 阳历几月&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1900&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 阳历年&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekDay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 阳历周几&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumDayToStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 距离1900年1月1日过去了多少天&lt;/span&gt;
	
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;moonCalendar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 农历几月初几&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ganzhiCalendar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 农历天干地支纪年纪月纪日&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shengxiaoYear&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 农历生肖&lt;/span&gt;
	
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JComboBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yearBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 年份选择&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JComboBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;monthBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 月份选择&lt;/span&gt;
	
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JLabel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dateLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 日期标签&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JLabel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;moonLabel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JLabel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ganzhiLabel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JLabel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shengxiaoLabel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;moon&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x04bd8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x04ae0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a570&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x054d5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x0d260&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d950&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x16554&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x056a0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x09ad0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x055d2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x04ae0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x0a5b6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a4d0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d250&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1d255&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0b540&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d6a0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0ada2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x095b0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x14977&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x04970&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a4b0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0b4b5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x06a50&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x06d40&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x1ab54&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x02b60&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x09570&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x052f2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x04970&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x06566&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d4a0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x0ea50&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x06e95&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x05ad0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x02b60&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x186e3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x092e0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1c8d7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x0c950&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d4a0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1d8a6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0b550&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x056a0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1a5b4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x025d0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x092d0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d2b2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a950&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0b557&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x06ca0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0b550&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15355&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x04da0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a5b0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x14573&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x052b0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a9a8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0e950&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x06aa0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x0aea6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0ab50&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x04b60&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0aae4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a570&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x05260&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0f263&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x0d950&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x05b57&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x056a0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x096d0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x04dd5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x04ad0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a4d0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x0d4d4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d250&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d558&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0b540&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0b6a0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x195a6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x095b0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x049b0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a974&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a4b0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0b27a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x06a50&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x06d40&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0af46&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x0ab60&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x09570&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x04af5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x04970&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x064b0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x074a3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0ea50&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x06b58&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x055c0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0ab60&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x096d5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x092e0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0c960&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d954&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x0d4a0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0da50&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x07552&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x056a0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0abb7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x025d0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x092d0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x0cab5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a950&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0b4a0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0baa4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0ad50&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x055d9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x04ba0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x0a5b0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x15176&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x052b0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a930&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x07954&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x06aa0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0ad50&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x05b52&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x04b60&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a6e6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a4e0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d260&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0ea65&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d530&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x05aa0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x076a3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x096d0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x04afb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x04ad0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a4d0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1d0b6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x0d250&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d520&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0dd45&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0b5a0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x056d0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x055b2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x049b0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x0a577&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a4b0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0aa50&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x1b255&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x06d20&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0ada0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x14b63&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x09370&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x049f8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x04970&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x064b0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x168a6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0ea50&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x06b20&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x1a6c4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0aae0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a2e0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d2e3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0c960&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d557&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d4a0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x0da50&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x05d55&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x056a0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a6d0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x055d4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x052d0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a9b8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x0a950&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0b4a0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0b6a6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0ad50&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x055a0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0aba4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a5b0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x052b0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0b273&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x06930&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x07337&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x06aa0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0ad50&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x14b55&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x04b60&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a570&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x054e4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d160&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0e968&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d520&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0daa0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x16aa6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x056d0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x04ae0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a9d4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0a2d0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0d150&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0f252&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;mh&quot;&gt;0x0d520&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gan&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;甲&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;乙&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;丙&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;丁&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;戊&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;己&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;庚&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;s&quot;&gt;&quot;辛&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;壬&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;癸&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zhi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;子&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;丑&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;寅&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;卯&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;辰&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;巳&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;午&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;s&quot;&gt;&quot;未&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;申&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;酉&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;戌&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;亥&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shengxiao&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;鼠&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;牛&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;虎&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;兔&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;龙&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;蛇&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;s&quot;&gt;&quot;马&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;羊&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;猴&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;鸡&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;狗&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;猪&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
	
	&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;MainFrame&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;setDefaultCloseOperation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;JFrame&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;EXIT_ON_CLOSE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;setBounds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;450&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;c1&quot;&gt;// System.out.println(moon.length);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;sunPane&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JPanel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BorderLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;moonPane&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JPanel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FlowLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;JPanel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;contentPane&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JPanel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BorderLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;contentPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sunPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BorderLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;CENTER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;contentPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;moonPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BorderLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;EAST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	
		&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;contentPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;JLabel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nongli&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;农历&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;nongli&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setFont&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Font&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;微软雅黑&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;48&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;moonPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BoxLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;moonPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BoxLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Y_AXIS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;moonPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nongli&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;moonPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setPreferredSize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dimension&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;moonPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;moonLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;moonPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ganzhiLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;moonPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shengxiaoLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;moonLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setFont&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Font&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;微软雅黑&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;ganzhiLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setFont&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Font&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;微软雅黑&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;shengxiaoLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setFont&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Font&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;微软雅黑&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;JPanel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;upPane&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JPanel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;sunPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;upPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BorderLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;NORTH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;yearBox&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JComboBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;();&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;monthBox&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JComboBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;();&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;JButton&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nextDate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JButton&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;下一天&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1900&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2100&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;yearBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addItem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;monthBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addItem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;月&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;dateLabel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;-&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;-&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;upPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yearBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;upPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;monthBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;upPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nextDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;upPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dateLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;JPanel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;display&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JPanel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GridLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;sunPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BorderLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;CENTER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;49&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;49&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;CENTER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addMouseListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MyLabelMouseAdapter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]);&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;日&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;一&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;二&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;三&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;四&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;五&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;六&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setForeground&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;blue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setBackground&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lightGray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setOpaque&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;moonPane&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setBackground&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ORANGE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;c1&quot;&gt;//JLabel moonLabel = new JLabel(&quot; 农历 &quot;);&lt;/span&gt;


		&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 一月&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 二月&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 三月&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 四月&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 五月&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 六月&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 七月&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 八月&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 九月&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 十月&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 十一月&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 十二月&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;yearBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addActionListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ActionListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
	
			&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
			&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;actionPerformed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ActionEvent&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
	
				&lt;span class=&quot;n&quot;&gt;refresh&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
	
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;monthBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addActionListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ActionListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
	
			&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
			&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;actionPerformed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ActionEvent&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
	
				&lt;span class=&quot;n&quot;&gt;refresh&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
	
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;nextDate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addActionListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ActionListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
	
			&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
			&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;actionPerformed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ActionEvent&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;c1&quot;&gt;// 下一天&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;yearBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setSelectedIndex&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1900&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;monthBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setSelectedIndex&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;day&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
	
				&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 每月的最后一天&lt;/span&gt;
				&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;monthBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setSelectedIndex&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;day&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;day&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;refresh&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
	
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;setCalendar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;month&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	
	&lt;span class=&quot;cm&quot;&gt;/**
	 * 设置日历，返回当月的第一天是周几，从0开始计数
	 *
	 * @param year
	 * @param month
	 */&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;setCalendar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;month&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
	
		&lt;span class=&quot;c1&quot;&gt;// int weekDay = 0;//该月份的第一天是周几，从0开始计数，0表示周一&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;sumDayToStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1900&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isLeepYear&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;sumDayToStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;366&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;sumDayToStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;365&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	
		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isLeepYear&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;29&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;sumDayToStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;weekDay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumDayToStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;c1&quot;&gt;// 清空日历&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setForeground&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;BLACK&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setBackground&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getBackground&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
	
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weekDay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weekDay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setForeground&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;RED&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weekDay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setBackground&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;WHITE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weekDay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setOpaque&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;sumDayToStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
	
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	
	&lt;span class=&quot;cm&quot;&gt;/**
	 * 判断是否为闰年
	 *
	 * @param year
	 * @return
	 */&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;isLeepYear&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
	
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	
	&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;refresh&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yearBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getSelectedIndex&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1900&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;monthBox&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getSelectedIndex&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;setCalendar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;month&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;dateLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;-&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;-&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;getMoonCalendar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
		&lt;span class=&quot;cm&quot;&gt;/*this.ganzhiLabel.setHorizontalAlignment(SwingConstants.CENTER);
		this.moonLabel.setHorizontalAlignment(SwingConstants.CENTER);
		this.ganzhiLabel.setHorizontalAlignment(SwingConstants.CENTER);*/&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ganzhiLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ganzhiCalendar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;moonLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;moonCalendar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;shengxiaoLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shengxiaoYear&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;年&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	
		&lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;moonCalendar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;　&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ganzhiCalendar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shengxiaoYear&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;


	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MyLabelMouseAdapter&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MouseAdapter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;mouseClicked&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MouseEvent&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
	
			&lt;span class=&quot;n&quot;&gt;JLabel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clickedLabel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;JLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getSource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
	
			&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;49&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clickedLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;day&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;refresh&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	
	&lt;span class=&quot;cm&quot;&gt;/**
	 * 计算是否为农历闰年
	 *
	 * @param yearIndex
	 *            ,年份索引，从0到200
	 * @return
	 */&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;isMoonLeapYear&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yearIndex&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;moon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x10000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	
	&lt;span class=&quot;cm&quot;&gt;/**
	 * 计算农历每年每月有多少天
	 *
	 * @param year
	 *            ，年份索引，从0到200
	 * @return
	 */&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getMoonMonthDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;months&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
	
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;moon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x10000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;29&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	
	&lt;span class=&quot;cm&quot;&gt;/**
	 * 获得农历日期，第多少年，第几月，第几天
	 */&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getMoonCalendar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sumDayToStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;day&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sumDayToStart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;sumDayToStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getMoonYearDays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sumDayToStart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getMoonYearDays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++;&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;leapMonth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;leapMonthDay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;months&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getMoonMonthDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;moon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 该年是阴历闰年&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;moon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x10000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x10000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 该年闰大月&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;leapMonthDay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 该年闰小月&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;leapMonthDay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;29&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;leapMonth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;moon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 闰几月&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;leapMonth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumDayToStart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
						&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
					&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
						&lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
					&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
				&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;leapMonth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 超过闰月了&lt;/span&gt;
					&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;leapMonthDay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumDayToStart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
						&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;leapMonthDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
						&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;leapMonth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
							&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumDayToStart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
								&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
							&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
								&lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
							&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
						&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
						&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
						&lt;span class=&quot;n&quot;&gt;day&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumDayToStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
					&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 在闰几月的时候停下&lt;/span&gt;
						&lt;span class=&quot;n&quot;&gt;day&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumDayToStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
					&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
				&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;day&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumDayToStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumDayToStart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
						&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
					&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
						&lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
					&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
				&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;day&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumDayToStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;c1&quot;&gt;// System.out.println(&quot;阴历一年多少天&quot;+getMoonYearDays(year));&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;moonCalendar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getYinliMonth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getYinliDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;shengxiaoYear&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shengxiao&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)%&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
		&lt;span class=&quot;cm&quot;&gt;/*System.out.println(this.moonCalendar);
		System.out.println(shengxiao[(year+12)%12]);
		System.out.println(&quot;阳历：&quot; + this.year + &quot;-&quot; + this.month + &quot;-&quot;
				+ this.day + &quot;阴历：&quot; + year + &quot;-&quot; + month + &quot;-&quot; + day);// 测试农历几月初几
*/&lt;/span&gt;		&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ganzhiCalendar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getGanZhi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;month&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;cm&quot;&gt;/*System.out.println(ganzhiCalendar);*/&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;cm&quot;&gt;/**
	 * 计算农历每年共有多少天
	 *
	 * @param yearIndex
	 *            ,年份索引，从0到200
	 * @return
	 */&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getMoonYearDays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yearIndex&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumDay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;months&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getMoonMonthDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yearIndex&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;sumDay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;months&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;moon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yearIndex&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;moon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yearIndex&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x10000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x10000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;sumDay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;sumDay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;29&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sumDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
	
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getYinliMonth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;month&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
	
		&lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;正月&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;二月&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;三月&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;四月&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;五月&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;六月&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;七月&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;八月&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;九月&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;十月&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;十一月&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;腊月&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;


	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getYinliDay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
	
		&lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;day&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;初一&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;初二&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;初三&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;初四&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;初五&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;初六&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;初七&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;初八&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;初九&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;初十&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;十一&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;十二&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;十三&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;十四&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;十五&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;十六&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;十七&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;二十八&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;19&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;十九&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;二十&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;二十一&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;二十二&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;二十三&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;二十四&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;二十五&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;二十六&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;27&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;二十七&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;二十八&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;29&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;二十九&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;三十&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
	
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getGanZhi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;month&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;day&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ganzhiYear&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ganzhiMonth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ganzhi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=(++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)%&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=(++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)%&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++){&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;ganzhi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gan&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zhi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;ganzhiYear&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ganzhi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;年&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;ganzhiMonth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ganzhi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)%&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;月&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;month&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)%&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ganzhiYear&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ganzhiMonth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Tue, 11 Apr 2017 18:32:20 +0800</pubDate>
        <link>http://localhost:4000/2017/04/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95%E4%BD%9C%E4%B8%9A</link>
        <guid isPermaLink="true">http://localhost:4000/2017/04/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95%E4%BD%9C%E4%B8%9A</guid>
        
        <category>java</category>
        
        <category>swing</category>
        
        
      </item>
    
  </channel>
</rss>
